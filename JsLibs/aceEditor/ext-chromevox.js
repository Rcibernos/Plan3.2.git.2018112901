define("ace/ext/chromevox",["require","exports","module","ace/editor","ace/config"],function(Z,q,L){var h={};h.SpeechProperty;h.Cursor;h.Token;h.Annotation;var f={rate:0.8,pitch:0.4,volume:0.9};var j={rate:1,pitch:0.5,volume:0.9};var n={rate:0.8,pitch:0.8,volume:0.9};var F={rate:0.8,pitch:0.3,volume:0.9};var ar={rate:0.8,pitch:0.7,volume:0.9};var aw={rate:0.8,pitch:0.8,volume:0.9};var l={punctuationEcho:"none",relativePitch:-0.6};var o="ALERT_NONMODAL";var K="ALERT_MODAL";var M="INVALID_KEYPRESS";var y="insertMode";var e="start";var Y=[{substr:";",newSubstr:" semicolon "},{substr:":",newSubstr:" colon "}];var d={SPEAK_ANNOT:"annots",SPEAK_ALL_ANNOTS:"all_annots",TOGGLE_LOCATION:"toggle_location",SPEAK_MODE:"mode",SPEAK_ROW_COL:"row_col",TOGGLE_DISPLACEMENT:"toggle_displacement",FOCUS_TEXT:"focus_text"};var D="CONTROL + SHIFT ";h.editor=null;var G=null;var a={};var ae=false;var ad=false;var b=false;var ax=null;var E={};var c={};var u=function(az){return D+String.fromCharCode(az)};var B=function(){var az=h.editor.keyBinding.getKeyboardHandler();return az.$id==="ace/keyboard/vim"};var t=function(az){return h.editor.getSession().getTokenAt(az.row,az.column+1)};var s=function(az){return h.editor.getSession().getLine(az.row)};var V=function(az){if(a[az.row]){cvox.Api.playEarcon(o)}if(ae){cvox.Api.stop();ai(az);aq(t(az));am(az.row,1)}else{am(az.row,0)}};var C=function(az){var aB=s(az);var aC=aB.substr(az.column-1);if(az.column===0){aC=" "+aB}var aA=/^\W(\w+)/;var aD=aA.exec(aC);return aD!==null};var ab={constant:{prop:f},entity:{prop:n},keyword:{prop:F},storage:{prop:ar},variable:{prop:aw},meta:{prop:j,replace:[{substr:"</",newSubstr:" closing tag "},{substr:"/>",newSubstr:" close tag "},{substr:"<",newSubstr:" tag start "},{substr:">",newSubstr:" tag end "}]}};var k={prop:k};var p=function(aE,aD){var aA=aE;for(var az=0;az<aD.length;az++){var aC=aD[az];var aB=new RegExp(aC.substr,"g");aA=aA.replace(aB,aC.newSubstr)}return aA};var J=function(aD,aC,az){var aB={};aB.value="";aB.type=aD[aC].type;for(var aA=aC;aA<az;aA++){aB.value+=aD[aA].value}return aB};var I=function(aE){if(aE.length<=1){return aE}var aD=[];var aB=0;for(var aA=1;aA<aE.length;aA++){var aC=aE[aB];var az=aE[aA];if(v(aC)!==v(az)){aD.push(J(aE,aB,aA));aB=aA}}aD.push(J(aE,aB,aE.length));return aD};var A=function(aA){var az=h.editor.getSession().getLine(aA);var aB=/^\s*$/;return aB.exec(az)!==null};var am=function(aB,aA){var aC=h.editor.getSession().getTokens(aB);if(aC.length===0||A(aB)){cvox.Api.playEarcon("EDITABLE_TEXT");return}aC=I(aC);var az=aC[0];aC=aC.filter(function(aD){return aD!==az});ao(az,aA);aC.forEach(aq)};var ap=function(az){ao(az,0)};var aq=function(az){ao(az,1)};var v=function(aB){if(!aB||!aB.type){return}var aA=aB.type.split(".");if(aA.length===0){return}var aC=aA[0];var az=ab[aC];if(!az){return k}return az};var ao=function(aB,az){var aA=v(aB);var aC=p(aB.value,Y);if(aA.replace){aC=p(aC,aA.replace)}cvox.Api.speak(aC,az,aA.prop)};var ai=function(az){var aA=s(az);cvox.Api.speak(aA[az.column],1)};var al=function(aB,az){var aC=s(az);var aA=aC.substring(aB.column,az.column);aA=aA.replace(/ /g," space ");cvox.Api.speak(aA)};var aj=function(aB,az){if(Math.abs(aB.column-az.column)!==1){var aA=s(az).length;if(az.column===0||az.column===aA){am(az.row,0);return}if(C(az)){cvox.Api.stop();aq(t(az));return}}ai(az)};var Q=function(aA,az){if(!h.editor.selection.isEmpty()){al(aA,az);cvox.Api.speak("selected",1)}else{if(ad){al(aA,az)}else{aj(aA,az)}}};var R=function(aA){if(b){b=false;return}var az=h.editor.selection.getCursor();if(az.row!==G.row){V(az)}else{Q(G,az)}G=az};var W=function(az){if(h.editor.selection.isEmpty()){cvox.Api.speak("unselected")}};var O=function(az){switch(az.action){case"remove":cvox.Api.speak(az.text,0,l);b=true;break;case"insert":cvox.Api.speak(az.text,0);b=true;break}};var z=function(az){var aB=az.row;var aA=az.column;return !a[aB]||!a[aB][aA]};var X=function(aA){a={};for(var aC=0;aC<aA.length;aC++){var az=aA[aC];var aD=az.row;var aB=az.column;if(!a[aD]){a[aD]={}}a[aD][aB]=az}};var N=function(aA){var az=h.editor.getSession().getAnnotations();var aB=az.filter(z);if(aB.length>0){cvox.Api.playEarcon(o)}X(az)};var ag=function(az){var aA=az.type+" "+az.text+" on "+aa(az.row,az.column);aA=aA.replace(";","semicolon");cvox.Api.speak(aA,1)};var ah=function(aB){var az=a[aB];for(var aA in az){ag(az[aA])}};var aa=function(aA,az){return"row "+(aA+1)+" column "+(az+1)};var ak=function(){cvox.Api.speak(aa(G.row,G.column))};var af=function(){for(var az in a){ah(az)}};var an=function(){if(!B()){return}switch(h.editor.keyBinding.$data.state){case y:cvox.Api.speak("Insert mode");break;case e:cvox.Api.speak("Command mode");break}};var au=function(){ae=!ae;if(ae){cvox.Api.speak("Speak location on row change enabled.")}else{cvox.Api.speak("Speak location on row change disabled.")}};var at=function(){ad=!ad;if(ad){cvox.Api.speak("Speak displacement on column changes.")}else{cvox.Api.speak("Speak current character or word on column changes.")}};var U=function(az){if(az.ctrlKey&&az.shiftKey){var aA=E[az.keyCode];if(aA){aA.func()}}};var P=function(aA,az){if(!B()){return}var aB=az.keyBinding.$data.state;if(aB===ax){return}switch(aB){case y:cvox.Api.playEarcon(K);cvox.Api.setKeyEcho(true);break;case e:cvox.Api.playEarcon(K);cvox.Api.setKeyEcho(false);break}ax=aB};var g=function(aA){var az=aA.detail.customCommand;var aB=c[az];if(aB){aB.func();h.editor.focus()}};var x=function(){var az=ac.map(function(aB){return{desc:aB.desc+u(aB.keyCode),cmd:aB.cmd}});var aA=document.querySelector("body");aA.setAttribute("contextMenuActions",JSON.stringify(az));aA.addEventListener("ATCustomEvent",g,true)};var S=function(az){if(az.match){am(G.row,0)}else{cvox.Api.playEarcon(M)}};var r=function(){h.editor.focus()};var ac=[{keyCode:49,func:function(){ah(G.row)},cmd:d.SPEAK_ANNOT,desc:"Speak annotations on line"},{keyCode:50,func:af,cmd:d.SPEAK_ALL_ANNOTS,desc:"Speak all annotations"},{keyCode:51,func:an,cmd:d.SPEAK_MODE,desc:"Speak Vim mode"},{keyCode:52,func:au,cmd:d.TOGGLE_LOCATION,desc:"Toggle speak row location"},{keyCode:53,func:ak,cmd:d.SPEAK_ROW_COL,desc:"Speak row and column"},{keyCode:54,func:at,cmd:d.TOGGLE_DISPLACEMENT,desc:"Toggle speak displacement"},{keyCode:55,func:r,cmd:d.FOCUS_TEXT,desc:"Focus text"}];var T=function(az,aA){h.editor=aA;aA.getSession().selection.on("changeCursor",R);aA.getSession().selection.on("changeSelection",W);aA.getSession().on("change",O);aA.getSession().on("changeAnnotation",N);aA.on("changeStatus",P);aA.on("findSearchBox",S);aA.container.addEventListener("keydown",U);G=aA.selection.getCursor()};var w=function(az){T(null,az);ac.forEach(function(aA){E[aA.keyCode]=aA;c[aA.cmd]=aA});az.on("focus",T);if(B()){cvox.Api.setKeyEcho(false)}x()};function i(){return(typeof(cvox)!=="undefined")&&cvox&&cvox.Api}var av=0;var H=15;function ay(az){if(i()){w(az)}else{av++;if(av>=H){return}window.setTimeout(ay,500,az)}}var m=Z("../editor").Editor;Z("../config").defineOptions(m.prototype,"editor",{enableChromevoxEnhancements:{set:function(az){if(az){ay(this)}},value:true}})});(function(){window.require(["ace/ext/chromevox"],function(){})})();