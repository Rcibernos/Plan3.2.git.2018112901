(function(h){var v=p();var k=o();var g=m();var i=n();var c={imagePlaceholder:undefined,cacheBust:false};var d={toSvg:u,toPng:t,toJpeg:r,toBlob:q,toPixelData:s,impl:{fontFaces:g,images:i,util:v,inliner:k,options:{}}};if(typeof module!=="undefined"){module.exports=d}else{h.domtoimage=d}function u(x,y){y=y||{};b(y);return Promise.resolve(x).then(function(z){return a(z,y.filter,true)}).then(f).then(j).then(w).then(function(z){return l(z,y.width||v.width(x),y.height||v.height(x))});function w(z){if(y.bgcolor){z.style.backgroundColor=y.bgcolor}if(y.width){z.style.width=y.width+"px"}if(y.height){z.style.height=y.height+"px"}if(y.style){Object.keys(y.style).forEach(function(A){z.style[A]=y.style[A]})}return z}}function s(w,x){return e(w,x||{}).then(function(y){return y.getContext("2d").getImageData(0,0,v.width(w),v.height(w)).data})}function t(w,x){return e(w,x||{}).then(function(y){return y.toDataURL()})}function r(w,x){x=x||{};return e(w,x).then(function(y){return y.toDataURL("image/jpeg",x.quality||1)})}function q(w,x){return e(w,x||{}).then(v.canvasToBlob)}function b(w){if(typeof(w.imagePlaceholder)==="undefined"){d.impl.options.imagePlaceholder=c.imagePlaceholder}else{d.impl.options.imagePlaceholder=w.imagePlaceholder}if(typeof(w.cacheBust)==="undefined"){d.impl.options.cacheBust=c.cacheBust}else{d.impl.options.cacheBust=w.cacheBust}}function e(w,y){return u(w,y).then(v.makeImage).then(v.delay(100)).then(function(A){var z=x(w);z.getContext("2d").drawImage(A,0,0);return z});function x(B){var z=document.createElement("canvas");z.width=y.width||v.width(B);z.height=y.height||v.height(B);if(y.bgcolor){var A=z.getContext("2d");A.fillStyle=y.bgcolor;A.fillRect(0,0,z.width,z.height)}return z}}function a(z,x,B){if(!B&&x&&!x(z)){return Promise.resolve()}return Promise.resolve(z).then(y).then(function(C){return w(z,C,x)}).then(function(C){return A(z,C)});function y(C){if(C instanceof HTMLCanvasElement){return v.makeImage(C.toDataURL())}return C.cloneNode(false)}function w(G,D,F){var C=G.childNodes;if(C.length===0){return Promise.resolve(D)}return E(D,v.asArray(C),F).then(function(){return D});function E(K,H,J){var I=Promise.resolve();H.forEach(function(L){I=I.then(function(){return a(L,J)}).then(function(M){if(M){K.appendChild(M)}})});return I}}function A(H,C){if(!(C instanceof Element)){return C}return Promise.resolve().then(E).then(D).then(F).then(G).then(function(){return C});function E(){I(window.getComputedStyle(H),C.style);function I(K,L){if(K.cssText){L.cssText=K.cssText}else{J(K,L)}function J(M,N){v.asArray(M).forEach(function(O){N.setProperty(O,M.getPropertyValue(O),M.getPropertyPriority(O))})}}}function D(){[":before",":after"].forEach(function(J){I(J)});function I(L){var N=window.getComputedStyle(H,L);var K=N.getPropertyValue("content");if(K===""||K==="none"){return}var J=v.uid();C.className=C.className+" "+J;var O=document.createElement("style");O.appendChild(M(J,L,N));C.appendChild(O);function M(P,R,V){var U="."+P+":"+R;var Q=V.cssText?T(V):S(V);return document.createTextNode(U+"{"+Q+"}");function T(X){var W=X.getPropertyValue("content");return X.cssText+" content: "+W+";"}function S(X){return v.asArray(X).map(W).join("; ")+";";function W(Y){return Y+": "+X.getPropertyValue(Y)+(X.getPropertyPriority(Y)?" !important":"")}}}}}function F(){if(H instanceof HTMLTextAreaElement){C.innerHTML=H.value}if(H instanceof HTMLInputElement){C.setAttribute("value",H.value)}}function G(){if(!(C instanceof SVGElement)){return}C.setAttribute("xmlns","http://www.w3.org/2000/svg");if(!(C instanceof SVGRectElement)){return}["width","height"].forEach(function(I){var J=C.getAttribute(I);if(!J){return}C.style.setProperty(I,J)})}}}function f(w){return g.resolveAll().then(function(x){var y=document.createElement("style");w.appendChild(y);y.appendChild(document.createTextNode(x));return w})}function j(w){return i.inlineAll(w).then(function(){return w})}function l(x,y,w){return Promise.resolve(x).then(function(z){z.setAttribute("xmlns","http://www.w3.org/1999/xhtml");return new XMLSerializer().serializeToString(z)}).then(v.escapeXhtml).then(function(z){return'<foreignObject x="0" y="0" width="100%" height="100%">'+z+"</foreignObject>"}).then(function(z){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+y+'" height="'+w+'">'+z+"</svg>"}).then(function(z){return"data:image/svg+xml;charset=utf-8,"+z})}function p(){return{escape:A,parseExtension:I,mimeType:H,dataAsUrl:y,isDataUrl:E,canvasToBlob:x,resolveUrl:K,getAndEncode:C,uid:M(),delay:z,asArray:w,escapeXhtml:B,makeImage:F,width:N,height:D};function G(){var P="application/font-woff";var O="image/jpeg";return{woff:P,woff2:P,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:O,jpeg:O,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function I(P){var O=/\.([^\.\/]*?)$/g.exec(P);if(O){return O[1]}else{return""}}function H(P){var O=I(P).toLowerCase();return G()[O]||""}function E(O){return O.search(/^(data:)/)!==-1}function L(O){return new Promise(function(T){var Q=window.atob(O.toDataURL().split(",")[1]);var S=Q.length;var P=new Uint8Array(S);for(var R=0;R<S;R++){P[R]=Q.charCodeAt(R)}T(new Blob([P],{type:"image/png"}))})}function x(O){if(O.toBlob){return new Promise(function(P){O.toBlob(P)})}return L(O)}function K(S,Q){var R=document.implementation.createHTMLDocument();var P=R.createElement("base");R.head.appendChild(P);var O=R.createElement("a");R.body.appendChild(O);P.href=Q;O.href=S;return O.href}function M(){var O=0;return function(){return"u"+P()+O++;function P(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function F(O){return new Promise(function(R,Q){var P=new Image();P.onload=function(){R(P)};P.onerror=Q;P.src=O})}function C(P){var O=30000;if(d.impl.options.cacheBust){P+=((/\?/).test(P)?"&":"?")+(new Date()).getTime()}return new Promise(function(U){var T=new XMLHttpRequest();T.onreadystatechange=Q;T.ontimeout=W;T.responseType="blob";T.timeout=O;T.open("GET",P,true);T.send();var S;if(d.impl.options.imagePlaceholder){var V=d.impl.options.imagePlaceholder.split(/,/);if(V&&V[1]){S=V[1]}}function Q(){if(T.readyState!==4){return}if(T.status!==200){if(S){U(S)}else{R("cannot fetch resource: "+P+", status: "+T.status)}return}var X=new FileReader();X.onloadend=function(){var Y=X.result.split(/,/)[1];U(Y)};X.readAsDataURL(T.response)}function W(){if(S){U(S)}else{R("timeout of "+O+"ms occured while fetching resource: "+P)}}function R(X){console.error(X);U("")}})}function y(O,P){return"data:"+P+";base64,"+O}function A(O){return O.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function z(O){return function(P){return new Promise(function(Q){setTimeout(function(){Q(P)},O)})}}function w(P){var O=[];var R=P.length;for(var Q=0;Q<R;Q++){O.push(P[Q])}return O}function B(O){return O.replace(/#/g,"%23").replace(/\n/g,"%0A")}function N(P){var O=J(P,"border-left-width");var Q=J(P,"border-right-width");return P.scrollWidth+O+Q}function D(P){var Q=J(P,"border-top-width");var O=J(P,"border-bottom-width");return P.scrollHeight+Q+O}function J(O,P){var Q=window.getComputedStyle(O).getPropertyValue(P);return parseFloat(Q.replace("px",""))}}function o(){var A=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:x,shouldProcess:z,impl:{readUrls:y,inline:w}};function z(B){return B.search(A)!==-1}function y(D){var C=[];var B;while((B=A.exec(D))!==null){C.push(B[1])}return C.filter(function(E){return !v.isDataUrl(E)})}function w(D,E,B,C){return Promise.resolve(E).then(function(G){return B?v.resolveUrl(G,B):G}).then(C||v.getAndEncode).then(function(G){return v.dataAsUrl(G,v.mimeType(E))}).then(function(G){return D.replace(F(E),"$1"+G+"$3")});function F(G){return new RegExp("(url\\(['\"]?)("+v.escape(G)+")(['\"]?\\))","g")}}function x(E,B,C){if(D()){return Promise.resolve(E)}return Promise.resolve(E).then(y).then(function(G){var F=Promise.resolve(E);G.forEach(function(H){F=F.then(function(I){return w(I,H,B,C)})});return F});function D(){return !z(E)}}}function m(){return{resolveAll:x,impl:{readAll:w}};function x(){return w(document).then(function(y){return Promise.all(y.map(function(z){return z.resolve()}))}).then(function(y){return y.join("\n")})}function w(){return Promise.resolve(v.asArray(document.styleSheets)).then(y).then(A).then(function(B){return B.map(z)});function A(B){return B.filter(function(C){return C.type===CSSRule.FONT_FACE_RULE}).filter(function(C){return k.shouldProcess(C.style.getPropertyValue("src"))})}function y(C){var B=[];C.forEach(function(E){try{v.asArray(E.cssRules||[]).forEach(B.push.bind(B))}catch(D){console.log("Error while reading CSS rules from "+E.href,D.toString())}});return B}function z(C){return{resolve:function B(){var D=(C.parentStyleSheet||{}).href;return k.inlineAll(C.cssText,D)},src:function(){return C.style.getPropertyValue("src")}}}}}function n(){return{inlineAll:w,impl:{newImage:x}};function x(y){return{inline:z};function z(A){if(v.isDataUrl(y.src)){return Promise.resolve()}return Promise.resolve(y.src).then(A||v.getAndEncode).then(function(B){return v.dataAsUrl(B,v.mimeType(y.src))}).then(function(B){return new Promise(function(D,C){y.onload=D;y.onerror=C;y.src=B})})}}function w(z){if(!(z instanceof Element)){return Promise.resolve(z)}return y(z).then(function(){if(z instanceof HTMLImageElement){return x(z).inline()}else{return Promise.all(v.asArray(z.childNodes).map(function(A){return w(A)}))}});function y(B){var A=B.style.getPropertyValue("background");if(!A){return Promise.resolve(B)}return k.inlineAll(A).then(function(C){B.style.setProperty("background",C,B.style.getPropertyPriority("background"))}).then(function(){return B})}}}})(this);