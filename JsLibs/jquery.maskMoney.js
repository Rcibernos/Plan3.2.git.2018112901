(function(a){if(!a.browser){a.browser={};a.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase());a.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase());a.browser.opera=/opera/.test(navigator.userAgent.toLowerCase());a.browser.msie=/msie/.test(navigator.userAgent.toLowerCase())}var b={destroy:function(){a(this).unbind(".maskMoney");if(a.browser.msie){this.onpaste=null}return this},mask:function(c){return this.each(function(){var d=a(this),e;if(typeof c==="number"){d.trigger("mask");e=a(d.val().split(/\D/)).last()[0].length;c=c.toFixed(e);d.val(c)}return d.trigger("mask")})},unmasked:function(){return this.map(function(){var e=(a(this).val()||"0"),d=e.indexOf("-")!==-1,c;a(e.split(/\D/).reverse()).each(function(g,f){if(f){c=f;return false}});e=e.replace(/\D/g,"");e=e.replace(new RegExp(c+"$"),"."+c);if(d){e="-"+e}return parseFloat(e)})},init:function(c){c=a.extend({prefix:"",suffix:"",affixesStay:true,thousands:",",decimal:".",precision:2,allowZero:false,allowNegative:false},c);return this.each(function(){var d=a(this),r;c=a.extend(c,d.data());function l(){var v=d.get(0),B=0,w=0,z,A,C,y,x;if(typeof v.selectionStart==="number"&&typeof v.selectionEnd==="number"){B=v.selectionStart;w=v.selectionEnd}else{A=document.selection.createRange();if(A&&A.parentElement()===v){y=v.value.length;z=v.value.replace(/\r\n/g,"\n");C=v.createTextRange();C.moveToBookmark(A.getBookmark());x=v.createTextRange();x.collapse(false);if(C.compareEndPoints("StartToEnd",x)>-1){B=w=y}else{B=-C.moveStart("character",-y);B+=z.slice(0,B).split("\n").length-1;if(C.compareEndPoints("EndToEnd",x)>-1){w=y}else{w=-C.moveEnd("character",-y);w+=z.slice(0,w).split("\n").length-1}}}}return{start:B,end:w}}function f(){var w=!(d.val().length>=d.attr("maxlength")&&d.attr("maxlength")>=0),y=l(),z=y.start,v=y.end,x=(y.start!==y.end&&d.val().substring(z,v).match(/\d/))?true:false,A=(d.val().substring(0,1)==="0");return w||x||A}function t(v){d.each(function(x,w){if(w.setSelectionRange){w.focus();w.setSelectionRange(v,v)}else{if(w.createTextRange){var y=w.createTextRange();y.collapse(true);y.moveEnd("character",v);y.moveStart("character",v);y.select()}}})}function u(w){var v="";if(w.indexOf("-")>-1){w=w.replace("-","");v="-"}return v+c.prefix+w+c.suffix}function q(B){var y=(B.indexOf("-")>-1&&c.allowNegative)?"-":"",A=B.replace(/[^0-9]/g,""),w=A.slice(0,A.length-c.precision),z,v,x;w=w.replace(/^0*/g,"");w=w.replace(/\B(?=(\d{3})+(?!\d))/g,c.thousands);if(w===""){w="0"}z=y+w;if(c.precision>0){v=A.slice(A.length-c.precision);x=new Array((c.precision+1)-v.length).join(0);z+=c.decimal+x+v}return u(z)}function p(x){var w=d.val().length,v;d.val(q(d.val()));v=d.val().length;x=x-(w-v);t(x)}function o(){var v=d.val();d.val(q(v))}function g(){var v=d.val();if(c.allowNegative){if(v!==""&&v.charAt(0)==="-"){return v.replace("-","")}else{return"-"+v}}else{return v}}function s(v){if(v.preventDefault){v.preventDefault()}else{v.returnValue=false}}function n(v){v=v||window.event;var x=v.which||v.charCode||v.keyCode,y,z,A,w,B;if(x===undefined){return false}if(x<48||x>57){if(x===45){d.val(g());return false}else{if(x===43){d.val(d.val().replace("-",""));return false}else{if(x===13||x===9){return true}else{if(a.browser.mozilla&&(x===37||x===39)&&v.charCode===0){return true}else{s(v);return true}}}}}else{if(!f()){return false}else{s(v);y=String.fromCharCode(x);z=l();A=z.start;w=z.end;B=d.val();d.val(B.substring(0,A)+y+B.substring(w,B.length));p(A+1);return false}}}function m(v){v=v||window.event;var x=v.which||v.charCode||v.keyCode,z,A,w,B,y;if(x===undefined){return false}z=l();A=z.start;w=z.end;if(x===8||x===46||x===63272){s(v);B=d.val();if(A===w){if(x===8){if(c.suffix===""){A-=1}else{y=B.split("").reverse().join("").search(/\d/);A=B.length-y-1;w=A+1}}else{w+=1}}d.val(B.substring(0,A)+B.substring(w,B.length));p(A);return false}else{if(x===9){return true}else{return true}}}function j(){r=d.val();o();var v=d.get(0),w;if(v.createTextRange){w=v.createTextRange();w.collapse(false);w.select()}}function i(){setTimeout(function(){o()},0)}function k(){var v=parseFloat("0")/Math.pow(10,c.precision);return(v.toFixed(c.precision)).replace(new RegExp("\\.","g"),c.decimal)}function e(v){if(a.browser.msie){n(v)}if(d.val()===""||d.val()===u(k())){if(!c.allowZero){d.val("")}else{if(!c.affixesStay){d.val(k())}else{d.val(u(k()))}}}else{if(!c.affixesStay){var w=d.val().replace(c.prefix,"").replace(c.suffix,"");d.val(w)}}if(d.val()!==r){d.change()}}function h(){var v=d.get(0),w;if(v.setSelectionRange){w=d.val().length;v.setSelectionRange(w,w)}else{d.val(d.val())}}d.unbind(".maskMoney");d.bind("keypress.maskMoney",n);d.bind("keydown.maskMoney",m);d.bind("blur.maskMoney",e);d.bind("focus.maskMoney",j);d.bind("click.maskMoney",h);d.bind("cut.maskMoney",i);d.bind("paste.maskMoney",i);d.bind("mask.maskMoney",o)})}};a.fn.maskMoney=function(c){if(b[c]){return b[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return b.init.apply(this,arguments)}else{a.error("Method "+c+" does not exist on jQuery.maskMoney")}}}})(window.jQuery||window.Zepto);