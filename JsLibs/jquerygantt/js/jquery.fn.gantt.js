(function(a,g){var h=24*60*60*1000;function b(l,o){var j=new Date(parseInt(o,10));j.setHours(0,0,0,0);var m=a(l).attr("id")||"";var n=m.indexOf("-")+1;var k=new Date(parseInt(m.substring(n,m.length),10));k.setHours(0,0,0,0);return j.getTime()===k.getTime()}a.expr[":"].findday=a.expr.createPseudo?a.expr.createPseudo(function(j){return function(k){return b(k,j)}}):function(j,k,l){return b(j,l[3])};function d(l,q){var j=new Date(parseInt(q,10));var s=j.getFullYear();var r=j.getWeekOfYear();var o=j.getMonth();if(o===11&&r===1){s++}else{if(!o&&r>51){s--}}j=s+"-"+r;var n=a(l).attr("id")||"";var p=n.indexOf("-")+1;var k=n.substring(p,n.length);return j===k}a.expr[":"].findweek=a.expr.createPseudo?a.expr.createPseudo(function(j){return function(k){return d(k,j)}}):function(j,k,l){return d(j,l[3])};function c(l,o){var j=new Date(parseInt(o,10));j=j.getFullYear()+"-"+j.getMonth();var m=a(l).attr("id")||"";var n=m.indexOf("-")+1;var k=m.substring(n,m.length);return j===k}a.expr[":"].findmonth=a.expr.createPseudo?a.expr.createPseudo(function(j){return function(k){return c(k,j)}}):function(j,k,l){return c(j,l[3])};Date.prototype.getWeekId=function(){var l=this.getFullYear();var k=this.getWeekOfYear();var j=this.getMonth();if(j===11&&k===1){l++}else{if(!j&&k>51){l--}}return"dh-"+l+"-"+k};Date.prototype.getRepDate=function(j){switch(j){case"hours":return this.getTime();case"weeks":return this.getDayForWeek().getTime();case"months":return new Date(this.getFullYear(),this.getMonth(),1).getTime();case"days":default:return this.getTime()}};Date.prototype.getDayOfYear=function(){var j=this.getFullYear();return(Date.UTC(j,this.getMonth(),this.getDate())-Date.UTC(j,0,0))/h};var e=1;var i=4;Date.prototype.getWeekOfYear=function(){var n=this.getFullYear(),m=this.getMonth(),j=this.getDate(),k=this.getDay();var l=i-k;if(k<e){l-=7}if(l+7<i-e){l+=7}return Math.ceil(new Date(n,m,j+l).getDayOfYear()/7)};Date.prototype.getDayForWeek=function(){var j=this.getDay();var k=(j<e?-7:0)+e-j;return new Date(this.getFullYear(),this.getMonth(),this.getDate()+k)};function f(j,m){for(var k=1;;k++){var l=new Date(j);l.setHours(j.getHours()+m*k);if(l.getTime()!==j.getTime()){return l}}}a.fn.gantt=function(k){var l=["hours","days","weeks","months"];var m={source:[],holidays:[],itemsPerPage:7,dow:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],waitText:"Please wait...",navigate:"buttons",scrollToToday:true,useCookie:false,cookieKey:"jquery.fn.gantt",scale:"days",maxScale:"months",minScale:"hours",onItemClick:function(o){return},onAddClick:function(o,p){return},onRender:a.noop};a.extend(m,k);m.useCookie=m.useCookie&&a.isFunction(a.cookie);var j={elementFromPoint:(function(){if(document.compatMode==="CSS1Compat"){return function(o,p){o-=window.pageXOffset;p-=window.pageYOffset;return document.elementFromPoint(o,p)}}return function(o,p){o-=a(document).scrollLeft();p-=a(document).scrollTop();return document.elementFromPoint(o,p)}})(),create:function(o){if(typeof m.source!=="string"){o.data=m.source;j.init(o)}else{a.getJSON(m.source,function(p){o.data=p;j.init(o)})}},init:function(o){o.rowsNum=o.data.length;o.pageCount=Math.ceil(o.rowsNum/m.itemsPerPage);o.rowsOnLastPage=o.rowsNum-(Math.floor(o.rowsNum/m.itemsPerPage)*m.itemsPerPage);o.dateStart=n.getMinDate(o);o.dateEnd=n.getMaxDate(o);j.waitToggle(o,function(){j.render(o)})},render:function(s){var r=a('<div class="fn-content"/>');var p=j.leftPanel(s);r.append(p);var q=j.rightPanel(s,p);var u,t;r.append(q);r.append(j.navigation(s));var o=q.find(".dataPanel");s.gantt=a('<div class="fn-gantt" />').append(r);a(s).empty().append(s.gantt);s.scrollNavigation.panelMargin=parseInt(o.css("margin-left").replace("px",""),10);s.scrollNavigation.panelMaxPos=(o.width()-q.width());s.scrollNavigation.canScroll=(o.width()>q.width());j.markNow(s);j.fillData(s,o,p);if(m.useCookie){var v=a.cookie(m.cookieKey+"ScrollPos");if(v){s.hPosition=v}}if(m.scrollToToday){j.navigateTo(s,"now");j.scrollPanel(s,0)}else{if(s.hPosition!==0){if(s.scaleOldWidth){u=(o.width()-q.width());t=u*s.hPosition/s.scaleOldWidth;s.hPosition=t>0?0:t;s.scaleOldWidth=null}o.css({"margin-left":s.hPosition});s.scrollNavigation.panelMargin=s.hPosition}j.repositionLabel(s)}o.css({height:p.height()});j.waitToggle(s);m.onRender()},leftPanel:function(o){var q=a('<div class="leftPanel"/>').append(a('<div class="row spacer"/>').css("height",n.getCellSize()*o.headerRows).css("width","100%"));var p=[];a.each(o.data,function(t,s){if(t>=o.pageNum*m.itemsPerPage&&t<(o.pageNum*m.itemsPerPage+m.itemsPerPage)){var r=("id" in s)?'" data-id="'+s.id:"";p.push('<div class="row name row'+t+(s.desc?"":(" fn-wide "+r))+'" id="rowheader'+t+'" data-offset="'+t%m.itemsPerPage*n.getCellSize()+'"><span class="fn-label'+(s.cssClass?" "+s.cssClass:"")+'">'+(s.name||"")+"</span></div>");if(s.desc){p.push('<div class="row desc row'+t+' " id="RowdId_'+t+r+'"><span class="fn-label'+(s.cssClass?" "+s.cssClass:"")+'">'+s.desc+"</span></div>")}}});return q.append(p.join(""))},dataPanel:function(p,r){var o=a('<div class="dataPanel" style="width: '+r+'px;"/>');var q="onwheel" in p?"wheel":document.onmousewheel!==g?"mousewheel":"DOMMouseScroll";a(p).on(q,function(s){j.wheelScroll(p,s)});o.click(function(x){x.stopPropagation();var t,u;var y=a(p).find(".fn-gantt .leftPanel");var v=a(p).find(".fn-gantt .dataPanel");switch(m.scale){case"months":u=n.getCellSize();break;case"hours":u=n.getCellSize()*4;break;case"days":u=n.getCellSize()*3;break;case"weeks":default:u=n.getCellSize()*2}var s=j.elementFromPoint(x.pageX,v.offset().top+u);if(s.className==="fn-label"){s=a(s.parentNode)}else{s=a(s)}var w=s.data("repdate");var z=j.elementFromPoint(y.offset().left+y.width()-10,x.pageY);if(z.className.indexOf("fn-label")===0){z=a(z.parentNode)}else{z=a(z)}var A=z.data("id");m.onAddClick(w,A)});return o},rightPanel:function(x,C){var G=null;var w=["sn","wd","wd","wd","wd","wd","sa"];var Q=[];var M=0;var F=[];var L=0;var s=[];var A=0;var v=[];var z=[];var N=new Date();N.setHours(0,0,0,0);var o=a('<div class="row header"></div>');var B,D;var P,E,O,r;var H,t;var p;switch(m.scale){case"hours":G=n.parseTimeRange(x.dateStart,x.dateEnd,x.scaleStep);P=G[0].getFullYear();E=G[0].getMonth();r=G[0];for(B=0,D=G.length;B<D;B++){H=G[B];var I=H.getFullYear();if(I!==P){Q.push('<div class="row header year" style="width: '+n.getCellSize()*M+'px;"><div class="fn-label">'+P+"</div></div>");P=I;M=0}M++;var K=H.getMonth();if(K!==E){F.push('<div class="row header month" style="width: '+n.getCellSize()*L+'px"><div class="fn-label">'+m.months[E]+"</div></div>");E=K;L=0}L++;var J=H.getDay();var y=r.getDay();if(J!==y){t=(N-r===0)?"today":n.isHoliday(r.getTime())?"holiday":w[y];s.push('<div class="row date '+t+'" style="width: '+n.getCellSize()*A+'px;"><div class="fn-label">'+r.getDate()+"</div></div>");v.push('<div class="row day '+t+'" style="width: '+n.getCellSize()*A+'px;"><div class="fn-label">'+m.dow[y]+"</div></div>");r=H;A=0}A++;t=w[J];if(n.isHoliday(H)){t="holiday"}z.push('<div class="row day '+t+'" id="dh-'+H.getTime()+'" data-offset="'+B*n.getCellSize()+'" data-repdate="'+H.getRepDate(m.scale)+'"><div class="fn-label">'+H.getHours()+"</div></div>")}Q.push('<div class="row header year" style="width: '+n.getCellSize()*M+'px;"><div class="fn-label">'+P+"</div></div>");F.push('<div class="row header month" style="width: '+n.getCellSize()*L+'px"><div class="fn-label">'+m.months[E]+"</div></div>");t=w[r.getDay()];if(n.isHoliday(r)){t="holiday"}s.push('<div class="row date '+t+'" style="width: '+n.getCellSize()*A+'px;"><div class="fn-label">'+r.getDate()+"</div></div>");v.push('<div class="row day '+t+'" style="width: '+n.getCellSize()*A+'px;"><div class="fn-label">'+m.dow[r.getDay()]+"</div></div>");p=j.dataPanel(x,G.length*n.getCellSize());p.append(o.clone().html(Q.join("")),o.clone().html(F.join("")),o.clone().html(s.join("")),o.clone().html(v.join("")),o.clone().html(z.join("")));break;case"weeks":G=n.parseWeeksRange(x.dateStart,x.dateEnd);P=G[0].getFullYear();E=G[0].getMonth();O=G[0].getWeekOfYear();var u;for(B=0,D=G.length;B<D;B++){H=G[B];if(O>(O=H.getWeekOfYear())){u=H.getDate()-1;u-=!H.getMonth()?0:31;u/=7;Q.push('<div class="row header year" style="width: '+n.getCellSize()*(M-u)+'px;"><div class="fn-label">'+P+"</div></div>");P++;M=u}M++;if(H.getMonth()!==E){u=H.getDate()-1;u/=7;F.push('<div class="row header month" style="width:'+n.getCellSize()*(L-u)+'px;"><div class="fn-label">'+m.months[E]+"</div></div>");E=H.getMonth();L=u}L++;s.push('<div class="row day wd" id="'+H.getWeekId()+'" data-offset="'+B*n.getCellSize()+'" data-repdate="'+H.getRepDate(m.scale)+'"><div class="fn-label">'+O+"</div></div>")}Q.push('<div class="row header year" style="width: '+n.getCellSize()*M+'px;"><div class="fn-label">'+P+"</div></div>");F.push('<div class="row header month" style="width: '+n.getCellSize()*L+'px"><div class="fn-label">'+m.months[E]+"</div></div>");p=j.dataPanel(x,G.length*n.getCellSize());p.append(o.clone().html(Q.join("")),o.clone().html(F.join("")),o.clone().html(s.join("")));break;case"months":G=n.parseMonthsRange(x.dateStart,x.dateEnd);P=G[0].getFullYear();E=G[0].getMonth();for(B=0,D=G.length;B<D;B++){H=G[B];if(H.getFullYear()!==P){Q.push('<div class="row header year" style="width: '+n.getCellSize()*M+'px;"><div class="fn-label">'+P+"</div></div>");P=H.getFullYear();M=0}M++;F.push('<div class="row day wd" id="dh-'+n.genId(H)+'" data-offset="'+B*n.getCellSize()+'" data-repdate="'+H.getRepDate(m.scale)+'">'+(1+H.getMonth())+"</div>")}Q.push('<div class="row header year" style="width: '+n.getCellSize()*M+'px;"><div class="fn-label">'+P+"</div></div>");F.push('<div class="row header month" style="width: '+n.getCellSize()*L+'px"><div class="fn-label">'+m.months[E]+"</div></div>");p=j.dataPanel(x,G.length*n.getCellSize());p.append(o.clone().html(Q.join("")),o.clone().html(F.join("")),o.clone().html(s.join("")),o.clone().html(v.join("")));break;default:G=n.parseDateRange(x.dateStart,x.dateEnd);var q=f(G[0],-1);P=q.getFullYear();E=q.getMonth();for(B=0,D=G.length;B<D;B++){H=G[B];if(H.getFullYear()!==P){Q.push('<div class="row header year" style="width:'+n.getCellSize()*M+'px;"><div class="fn-label">'+P+"</div></div>");P=H.getFullYear();M=0}M++;if(H.getMonth()!==E){F.push('<div class="row header month" style="width:'+n.getCellSize()*L+'px;"><div class="fn-label">'+m.months[E]+"</div></div>");E=H.getMonth();L=0}L++;r=H.getDay();t=w[r];if(n.isHoliday(H)){t="holiday"}s.push('<div class="row date '+t+'" id="dh-'+n.genId(H)+'" data-offset="'+B*n.getCellSize()+'" data-repdate="'+H.getRepDate(m.scale)+'"><div class="fn-label">'+H.getDate()+"</div></div>");v.push('<div class="row day '+t+'" id="dw-'+n.genId(H)+'" data-repdate="'+H.getRepDate(m.scale)+'"><div class="fn-label">'+m.dow[r]+"</div></div>")}Q.push('<div class="row header year" style="width: '+n.getCellSize()*M+'px;"><div class="fn-label">'+P+"</div></div>");F.push('<div class="row header month" style="width: '+n.getCellSize()*L+'px"><div class="fn-label">'+m.months[E]+"</div></div>");p=j.dataPanel(x,G.length*n.getCellSize());p.append(o.clone().html(Q.join("")),o.clone().html(F.join("")),o.clone().html(s.join("")),o.clone().html(v.join("")))}return a('<div class="rightPanel"></div>').append(p)},navigation:function(o){var p=null;if(m.navigate==="scroll"){p=a('<div class="navigate" />').append(a('<div class="nav-slider" />').append(a('<div class="nav-slider-left" />').append(a('<button type="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){j.navigatePage(o,-1)})).append(a('<div class="page-number"/>').append(a("<span/>").html(o.pageNum+1+" / "+o.pageCount))).append(a('<button type="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){j.navigatePage(o,1)})).append(a('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){j.navigateTo(o,"now")})).append(a('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){if(m.scale==="hours"){j.navigateTo(o,n.getCellSize()*8)}else{if(m.scale==="days"){j.navigateTo(o,n.getCellSize()*30)}else{if(m.scale==="weeks"){j.navigateTo(o,n.getCellSize()*12)}else{if(m.scale==="months"){j.navigateTo(o,n.getCellSize()*6)}}}}})).append(a('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){if(m.scale==="hours"){j.navigateTo(o,n.getCellSize()*4)}else{if(m.scale==="days"){j.navigateTo(o,n.getCellSize()*7)}else{if(m.scale==="weeks"){j.navigateTo(o,n.getCellSize()*4)}else{if(m.scale==="months"){j.navigateTo(o,n.getCellSize()*3)}}}}}))).append(a('<div class="nav-slider-content" />').append(a('<div class="nav-slider-bar" />').append(a('<a class="nav-slider-button" />')).mousedown(function(q){q.preventDefault();o.scrollNavigation.scrollerMouseDown=true;j.sliderScroll(o,q)}).mousemove(function(q){if(o.scrollNavigation.scrollerMouseDown){j.sliderScroll(o,q)}}))).append(a('<div class="nav-slider-right" />').append(a('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){if(m.scale==="hours"){j.navigateTo(o,n.getCellSize()*-4)}else{if(m.scale==="days"){j.navigateTo(o,n.getCellSize()*-7)}else{if(m.scale==="weeks"){j.navigateTo(o,n.getCellSize()*-4)}else{if(m.scale==="months"){j.navigateTo(o,n.getCellSize()*-3)}}}}})).append(a('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){if(m.scale==="hours"){j.navigateTo(o,n.getCellSize()*-8)}else{if(m.scale==="days"){j.navigateTo(o,n.getCellSize()*-30)}else{if(m.scale==="weeks"){j.navigateTo(o,n.getCellSize()*-12)}else{if(m.scale==="months"){j.navigateTo(o,n.getCellSize()*-6)}}}}})).append(a('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){j.zoomInOut(o,-1)})).append(a('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){j.zoomInOut(o,1)}))));a(document).mouseup(function(){o.scrollNavigation.scrollerMouseDown=false})}else{p=a('<div class="navigate" />').append(a('<button type="button" class="nav-link nav-page-back"/>').html("&lt;").click(function(){j.navigatePage(o,-1)})).append(a('<div class="page-number"/>').append(a("<span/>").html(o.pageNum+1+" / "+o.pageCount))).append(a('<button type="button" class="nav-link nav-page-next"/>').html("&gt;").click(function(){j.navigatePage(o,1)})).append(a('<button type="button" class="nav-link nav-begin"/>').html("&#124;&lt;").click(function(){j.navigateTo(o,"begin")})).append(a('<button type="button" class="nav-link nav-prev-week"/>').html("&lt;&lt;").click(function(){j.navigateTo(o,n.getCellSize()*7)})).append(a('<button type="button" class="nav-link nav-prev-day"/>').html("&lt;").click(function(){j.navigateTo(o,n.getCellSize())})).append(a('<button type="button" class="nav-link nav-now"/>').html("&#9679;").click(function(){j.navigateTo(o,"now")})).append(a('<button type="button" class="nav-link nav-next-day"/>').html("&gt;").click(function(){j.navigateTo(o,n.getCellSize()*-1)})).append(a('<button type="button" class="nav-link nav-next-week"/>').html("&gt;&gt;").click(function(){j.navigateTo(o,n.getCellSize()*-7)})).append(a('<button type="button" class="nav-link nav-end"/>').html("&gt;&#124;").click(function(){j.navigateTo(o,"end")})).append(a('<button type="button" class="nav-link nav-zoomIn"/>').html("&#43;").click(function(){j.zoomInOut(o,-1)})).append(a('<button type="button" class="nav-link nav-zoomOut"/>').html("&#45;").click(function(){j.zoomInOut(o,1)}))}return a('<div class="bottom"></div>').append(p)},createProgressBar:function(t,v,u,r,s){v=v||"";var q=n.getCellSize();var p=n.getProgressBarMargin()||0;var o=a('<div class="bar"><div class="fn-label">'+v+"</div></div>").css({width:((q*t)-p)+2}).data("dataObj",s);if(u){o.mouseenter(function(w){var x=a('<div class="fn-gantt-hint" />').html(u);a("body").append(x);x.css("left",w.pageX);x.css("top",w.pageY);x.show()}).mouseleave(function(){a(".fn-gantt-hint").remove()}).mousemove(function(w){a(".fn-gantt-hint").css("left",w.pageX);a(".fn-gantt-hint").css("top",w.pageY+15)})}if(r){o.addClass(r)}o.click(function(w){w.stopPropagation();m.onItemClick(a(this).data("dataObj"))});return o},markNow:function(p){var o=new Date().setHours(0,0,0,0);switch(m.scale){case"weeks":a(p).find(':findweek("'+o+'")').removeClass("wd").addClass("today");break;case"months":a(p).find(':findmonth("'+o+'")').removeClass("wd").addClass("today");break;case"days":case"hours":default:a(p).find(':findday("'+o+'")').removeClass("wd").addClass("today")}},fillData:function(p,o,r){var q=function(t){try{t=t.replace("rgb(","").replace(")","");var y=t.split(",");var x=parseInt(y[0],10);var v=parseInt(y[1],10);var s=parseInt(y[2],10);var w=Math.round((255-(0.299*x+0.587*v+0.114*s))*0.9);return"rgb("+w+", "+w+", "+w+")"}catch(u){return""}};a.each(p.data,function(t,s){if(t>=p.pageNum*m.itemsPerPage&&t<(p.pageNum*m.itemsPerPage+m.itemsPerPage)){a.each(s.values,function(E,y){var v;var C,F,w,x,z,B,A;var H,G;switch(m.scale){case"hours":z=n.genId(n.dateDeserialize(y.from),p.scaleStep);C=a(p).find("#dh-"+z);B=n.genId(n.dateDeserialize(y.to),p.scaleStep);F=a(p).find("#dh-"+B);w=C.data("offset");x=F.data("offset");A=Math.floor((x-w)/n.getCellSize())+1;v=j.createProgressBar(A,y.label,y.desc,y.customClass,y.dataObj);H=a(p).find("#rowheader"+t);G=n.getCellSize()*5+2+H.data("offset");v.css({top:G,left:Math.floor(w)});o.append(v);break;case"weeks":z=n.dateDeserialize(y.from);B=n.dateDeserialize(y.to);C=a(p).find("#"+z.getWeekId());w=C.data("offset");F=a(p).find("#"+B.getWeekId());x=F.data("offset");A=Math.round((x-w)/n.getCellSize())+1;v=j.createProgressBar(A,y.label,y.desc,y.customClass,y.dataObj);H=a(p).find("#rowheader"+t);G=n.getCellSize()*3+2+H.data("offset");v.css({top:G,left:Math.floor(w)});o.append(v);break;case"months":z=n.dateDeserialize(y.from);B=n.dateDeserialize(y.to);if(z.getDate()<=3&&z.getMonth()===0){z.setDate(z.getDate()+4)}if(z.getDate()<=3&&z.getMonth()===0){z.setDate(z.getDate()+4)}if(B.getDate()<=3&&B.getMonth()===0){B.setDate(B.getDate()+4)}C=a(p).find("#dh-"+n.genId(z));w=C.data("offset");F=a(p).find("#dh-"+n.genId(B));x=F.data("offset");A=Math.round((x-w)/n.getCellSize())+1;v=j.createProgressBar(A,y.label,y.desc,y.customClass,y.dataObj);H=a(p).find("#rowheader"+t);G=n.getCellSize()*2+2+H.data("offset");v.css({top:G,left:Math.floor(w)});o.append(v);break;case"days":default:z=n.genId(n.dateDeserialize(y.from));B=n.genId(n.dateDeserialize(y.to));C=a(p).find("#dh-"+z);w=C.data("offset");A=Math.floor((B-z)/h)+1;v=j.createProgressBar(A,y.label,y.desc,y.customClass,y.dataObj);H=a(p).find("#rowheader"+t);G=n.getCellSize()*4+2+H.data("offset");v.css({top:G,left:Math.floor(w)});o.append(v)}var u=v.find(".fn-label");if(u&&v.length){var D=q(v[0].style.backgroundColor);u.css("color",D)}else{if(u){u.css("color","")}}})}})},navigateTo:function(s,x){var p=a(s).find(".fn-gantt .rightPanel");var o=p.find(".dataPanel");var v=p.width();var r=o.width();var w=function(){j.repositionLabel(s)};var t,q;switch(x){case"begin":o.animate({"margin-left":"0px"},"fast",w);s.scrollNavigation.panelMargin=0;break;case"end":var u=r-v;s.scrollNavigation.panelMargin=u*-1;o.animate({"margin-left":"-"+u},"fast",w);break;case"now":if(!s.scrollNavigation.canScroll||!o.find(".today").length){return false}t=(r-v)*-1;q=o.css("margin-left").replace("px","");x=o.find(".today").offset().left-o.offset().left;x*=-1;if(x>0){x=0}else{if(x<t){x=t}}o.animate({"margin-left":x},"fast",w);s.scrollNavigation.panelMargin=x;break;default:t=(r-v)*-1;q=o.css("margin-left").replace("px","");x=parseInt(q,10)+x;if(x<=0&&x>=t){o.animate({"margin-left":x},"fast",w)}s.scrollNavigation.panelMargin=x}j.synchronizeScroller(s)},navigatePage:function(o,p){if((o.pageNum+p)>=0&&(o.pageNum+p)<Math.ceil(o.rowsNum/m.itemsPerPage)){j.waitToggle(o,function(){o.pageNum+=p;o.hPosition=a(".fn-gantt .dataPanel").css("margin-left").replace("px","");o.scaleOldWidth=false;j.init(o)})}},zoomInOut:function(o,p){j.waitToggle(o,function(){var v=(p<0);var u=o.scaleStep+p*3;u=u<=1?1:u===4?3:u;var t=m.scale;var s=o.headerRows;if(m.scale==="hours"&&u>=13){t="days";s=4;u=13}else{if(m.scale==="days"&&v){t="hours";s=5;u=12}else{if(m.scale==="days"&&!v){t="weeks";s=3;u=13}else{if(m.scale==="weeks"&&!v){t="months";s=2;u=14}else{if(m.scale==="weeks"&&v){t="days";s=4;u=13}else{if(m.scale==="months"&&v){t="weeks";s=3;u=13}}}}}}if((v&&a.inArray(t,l)<a.inArray(m.minScale,l))||(!v&&a.inArray(t,l)>a.inArray(m.maxScale,l))){j.init(o);return}o.scaleStep=u;m.scale=t;o.headerRows=s;var r=a(o).find(".fn-gantt .rightPanel");var q=r.find(".dataPanel");o.hPosition=q.css("margin-left").replace("px","");o.scaleOldWidth=(q.width()-r.width());if(m.useCookie){a.cookie(m.cookieKey+"CurrentScale",m.scale);a.cookie(m.cookieKey+"ScrollPos",null)}j.init(o)})},mouseScroll:function(s,r){var o=a(s).find(".fn-gantt .dataPanel");o.css("cursor","move");var p=o.offset();var t=s.scrollNavigation.mouseX===null?r.pageX:s.scrollNavigation.mouseX;var q=r.pageX-t;s.scrollNavigation.mouseX=r.pageX;j.scrollPanel(s,q);clearTimeout(s.scrollNavigation.repositionDelay);s.scrollNavigation.repositionDelay=setTimeout(j.repositionLabel,50,s)},wheelScroll:function(q,p){p.preventDefault();var o=("detail" in p?p.detail:"wheelDelta" in p.originalEvent?-1/120*p.originalEvent.wheelDelta:p.originalEvent.deltaY?p.originalEvent.deltaY/Math.abs(p.originalEvent.deltaY):p.originalEvent.detail);j.scrollPanel(q,-50*o);clearTimeout(q.scrollNavigation.repositionDelay);q.scrollNavigation.repositionDelay=setTimeout(j.repositionLabel,50,q)},sliderScroll:function(v,u){var q=a(v).find(".nav-slider-bar");var r=q.find(".nav-slider-button");var p=a(v).find(".fn-gantt .rightPanel");var o=p.find(".dataPanel");var s=q.offset();var t=q.width();var z=r.width();var x,w;if((u.pageX>=s.left)&&(u.pageX<=s.left+t)){x=u.pageX-s.left;x=x-z/2;r.css("left",x);w=o.width()-p.width();var y=x*w/t*-1;if(y>=0){o.css("margin-left","0px");v.scrollNavigation.panelMargin=0}else{if(x>=t-(z*1)){o.css("margin-left",w*-1);v.scrollNavigation.panelMargin=w*-1}else{o.css("margin-left",y);v.scrollNavigation.panelMargin=y}}clearTimeout(v.scrollNavigation.repositionDelay);v.scrollNavigation.repositionDelay=setTimeout(j.repositionLabel,5,v)}},scrollPanel:function(q,p){if(!q.scrollNavigation.canScroll){return false}var o=parseInt(q.scrollNavigation.panelMargin,10)+p;if(o>0){q.scrollNavigation.panelMargin=0;a(q).find(".fn-gantt .dataPanel").css("margin-left",q.scrollNavigation.panelMargin)}else{if(o<q.scrollNavigation.panelMaxPos*-1){q.scrollNavigation.panelMargin=q.scrollNavigation.panelMaxPos*-1;a(q).find(".fn-gantt .dataPanel").css("margin-left",q.scrollNavigation.panelMargin)}else{q.scrollNavigation.panelMargin=o;a(q).find(".fn-gantt .dataPanel").css("margin-left",q.scrollNavigation.panelMargin)}}j.synchronizeScroller(q)},synchronizeScroller:function(t){if(m.navigate!=="scroll"){return}var p=a(t).find(".fn-gantt .rightPanel");var o=p.find(".dataPanel");var q=a(t).find(".nav-slider-bar");var r=q.find(".nav-slider-button");var s=q.width();var x=r.width();var v=o.width()-p.width();var u=o.css("margin-left")||0;if(u){u=u.replace("px","")}var w=u*s/v-r.width()*0.25;w=w>0?0:(w*-1>=s-(x*0.75))?(s-(x*1.25))*-1:w;r.css("left",w*-1)},repositionLabel:function(o){setTimeout(function(){var p;if(!o){p=a(".fn-gantt .rightPanel .dataPanel")}else{var q=a(o).find(".fn-gantt .rightPanel");p=q.find(".dataPanel")}if(m.useCookie){a.cookie(m.cookieKey+"ScrollPos",p.css("margin-left").replace("px",""))}},500)},waitToggle:function(q,t){if(a.isFunction(t)){var o=a(q);var r=o.offset();var s=o.outerWidth();var p=o.outerHeight();if(!q.loader){q.loader=a('<div class="fn-gantt-loader"><div class="fn-gantt-loader-spinner"><span>'+m.waitText+"</span></div></div>")}o.append(q.loader);setTimeout(t,500)}else{if(q.loader){q.loader.detach()}}}};var n={getMaxDate:function(p){var q=null;a.each(p.data,function(t,s){a.each(s.values,function(v,u){q=q<n.dateDeserialize(u.to)?n.dateDeserialize(u.to):q})});q=q||new Date();var o;switch(m.scale){case"hours":q.setHours(Math.ceil((q.getHours())/p.scaleStep)*p.scaleStep);q.setHours(q.getHours()+p.scaleStep*3);break;case"weeks":o=new Date(q.getTime());o=new Date(o.setDate(o.getDate()+3*7));var r=Math.floor(o.getDate()/7)*7;q=new Date(o.getFullYear(),o.getMonth(),r===0?4:r-3);break;case"months":o=new Date(q.getFullYear(),q.getMonth(),1);o.setMonth(o.getMonth()+2);q=new Date(o.getFullYear(),o.getMonth(),1);break;case"days":default:q.setHours(0);q.setDate(q.getDate()+3)}return q},getMinDate:function(p){var r=null;a.each(p.data,function(t,s){a.each(s.values,function(v,u){r=r>n.dateDeserialize(u.from)||r===null?n.dateDeserialize(u.from):r})});r=r||new Date();switch(m.scale){case"hours":r.setHours(Math.floor((r.getHours())/p.scaleStep)*p.scaleStep);r.setHours(r.getHours()-p.scaleStep*3);break;case"weeks":var o=new Date(r.getTime());o=new Date(o.setDate(o.getDate()-3*7));var q=Math.floor(o.getDate()/7)*7;r=new Date(o.getFullYear(),o.getMonth(),q===0?4:q-3);break;case"months":r.setHours(0,0,0,0);r.setDate(1);r.setMonth(r.getMonth()-3);break;case"days":default:r.setHours(0,0,0,0);r.setDate(r.getDate()-3)}return r},parseDateRange:function(p,s){var o=new Date(p.getTime());var r=[];var q=0;do{r[q++]=new Date(o.getTime());o.setDate(o.getDate()+1)}while(o<=s);return r},parseTimeRange:function(r,v,u){var o=new Date(r);var q=new Date(v);o.setHours(0,0,0,0);q.setMilliseconds(0);q.setSeconds(0);if(q.getMinutes()>0||q.getHours()>0){q.setMinutes(0);q.setHours(0);q.setTime(q.getTime()+h)}var t=[];var s=0;for(;;){var p=new Date(o);p.setHours(Math.floor((o.getHours())/u)*u);if(t[s]&&p.getDay()!==t[s].getDay()){p.setHours(0)}t[s]=p;if(o>v){break}o=f(p,u);s++}return t},parseWeeksRange:function(p,s){var o=p.getDayForWeek();var r=[];var q=0;do{r[q++]=o.getDayForWeek();o.setDate(o.getDate()+7)}while(o<=s);return r},parseMonthsRange:function(q,t){var o=new Date(q);var p=new Date(t);var s=[];var r=0;do{s[r++]=new Date(o.getFullYear(),o.getMonth(),1);o.setMonth(o.getMonth()+1)}while(o<=t);return s},dateDeserialize:function(o){if(typeof o==="string"){o=o.replace(/\/Date\((.*)\)\//,"$1");o=a.isNumeric(o)?parseInt(o,10):a.trim(o)}return new Date(o)},genId:function(q){if(a.isNumeric(q)){q=new Date(q)}switch(m.scale){case"hours":var o=q.getHours();if(arguments.length>=2){o=(Math.floor(q.getHours()/arguments[1])*arguments[1])}return(new Date(q.getFullYear(),q.getMonth(),q.getDate(),o)).getTime();case"weeks":var s=q.getFullYear();var r=q.getWeekOfYear();var p=q.getMonth();if(p===11&&r===1){s++}else{if(!p&&r>51){s--}}return s+"-"+r;case"months":return q.getFullYear()+"-"+q.getMonth();case"days":default:return(new Date(q.getFullYear(),q.getMonth(),q.getDate())).getTime()}},_datesToDays:function(o){var q={};for(var r=0,s=o.length,p;r<s;r++){p=n.dateDeserialize(o[r]);q[p.setHours(0,0,0,0)]=true}return q},isHoliday:(function(){if(!m.holidays||!m.holidays.length){return function(){return false}}var o=false;return function(p){if(!o){o=n._datesToDays(m.holidays)}return !!o[a.isNumeric(p)?p:(new Date(p.getFullYear(),p.getMonth(),p.getDate())).getTime()]}})(),getCellSize:function(){if(typeof n._getCellSize==="undefined"){var o=a('<div style="display: none; position: absolute;" class="fn-gantt"><div class="row"></div></div>');a("body").append(o);n._getCellSize=o.find(".row").height();o.empty().remove()}return n._getCellSize},getPageHeight:function(o){return o.pageNum+1===o.pageCount?o.rowsOnLastPage*n.getCellSize():m.itemsPerPage*n.getCellSize()},getProgressBarMargin:function(){if(typeof n._getProgressBarMargin==="undefined"){var p=a('<div style="display: none; position: absolute;"><div class="fn-gantt"><div class="rightPanel"><div class="dataPanel"><div class="row day"><div class="bar"></div></div></div></div></div></div>');var o=p.find(".fn-gantt .rightPanel .day .bar");a("body").append(p);n._getProgressBarMargin=parseInt(o.css("margin-left").replace("px",""),10);n._getProgressBarMargin+=parseInt(o.css("margin-right").replace("px",""),10);p.empty().remove()}return n._getProgressBarMargin}};this.each(function(){this.data=null;this.pageNum=0;this.pageCount=0;this.rowsOnLastPage=0;this.rowsNum=0;this.hPosition=0;this.dateStart=null;this.dateEnd=null;this.scrollClicked=false;this.scaleOldWidth=null;this.headerRows=null;if(m.useCookie){var o=a.cookie(m.cookieKey+"CurrentScale");if(o){m.scale=o}else{a.cookie(m.cookieKey+"CurrentScale",m.scale)}}switch(m.scale){case"hours":this.headerRows=5;this.scaleStep=1;break;case"weeks":this.headerRows=3;this.scaleStep=13;break;case"months":this.headerRows=2;this.scaleStep=14;break;case"days":default:this.headerRows=4;this.scaleStep=13}this.scrollNavigation={panelMouseDown:false,scrollerMouseDown:false,mouseX:null,panelMargin:0,repositionDelay:0,panelMaxPos:0,canScroll:true};this.gantt=null;this.loader=null;j.create(this)})}})(jQuery);