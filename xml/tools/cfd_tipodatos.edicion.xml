<form id="cfd_tipodatos.edicion" tablaanexa="CFD_TIPODATOS" nbcampoid="ID" nombreexterno="Edicion" nbbtablaoriginal="" ayuda="" sqlcamposvista="SELECT CFD_TIPODATOS.Id,&#xD;CFD_TIPODATOS.Nombre AS [Nombre|Nombre],CFD_TIPODATOS.Nbtabla AS [Nbtabla|Tabla Datos],&#xD;CFD_TIPODATOS.Nbcampoid AS [Nbcampoid|Campo ID],CFD_TIPODATOS.Nbcampotitulo AS [Nbcampotitulo|Campo título],&#xD;Padre_TB.Nombre AS [Padre|Padre],CFD_TIPODATOS.Sqlinit AS [Sqlinit|Sql Init],CFD_TIPODATOS.Tiposql AS [Tiposql|TipoSql],&#xD;CFD_TIPODATOS.Sqlinithijo AS [Sqlinithijo|¬Sql Init Hijo (Para hijos)],CFD_TIPODATOS.Sqlleerregistro AS [Sqlleerregistro|SqlLeerRegistro],&#xD;CFD_TIPODATOS.Tipopgs AS [Tipopgs|TipoPGS],dbo.PonerPuntuacionNumericaEntera(CFD_TIPODATOS.Catalogtipocontrol) AS [Catalogtipocontrol|CatalogTipoControl],&#xD;CFD_TIPODATOS.Tiposcondicion AS [Tiposcondicion|TiposCondicion],dbo.PonerPuntuacionNumericaEntera(CFD_TIPODATOS.Sistema) AS [Sistema|Sistema],&#xD;dbo.PonerPuntuacionNumericaEntera(CFD_TIPODATOS.Vinculada) AS [Vinculada|Vinculada],&#xD;dbo.PonerPuntuacionNumericaEntera(CFD_TIPODATOS.Id) AS [Id|id]&#xD; FROM CFD_TIPODATOS&#xD;LEFT OUTER JOIN CFD_TIPODATOS Padre_TB ON CFD_TIPODATOS.Padre=Padre_TB.Id&#xD; WHERE CFD_TIPODATOS.Id=" dynaplantilla="" triggeralter="" estilo="" modocalculo="" nombrepadreid="" omitirpadreid="1" condiferencias="0" ncol="" version="3" dynavalidador="/*[type=jscript]*/ &#xA;&#xA;var nbTabla = $F.getValue(&quot;NBTABLA&quot;).toLowerCase();&#xA;var nbCampoId = $F.getValue(&quot;NBCAMPOID&quot;).toLowerCase().replace(nbTabla + &quot;.&quot;, &quot;&quot;);&#xA;var nbCampoTitulo = $F.getValue(&quot;NBCAMPOTITULO&quot;).toLowerCase().replace(nbTabla + &quot;.&quot;, &quot;&quot;);&#xA;var longMax;&#xA;var CaracteresValidos = &quot;abcdefghijklmnopqrstuvwxyz0123456789_&quot;;&#xA;&#xA;validLong(nbTabla); validLong(nbCampoId); validLong(nbCampoTitulo);&#xA;validCaract(nbTabla); validCaract(nbCampoId); validCaract(nbCampoTitulo);&#xA;&#xA;function validLong(campo){&#xA;    if ($db.type == &quot;oracle&quot;) {&#xA;        longMax = 30;    &#xA;    } else if ($db.type == &quot;postgresql&quot;) {&#xA;        longMax = 128;&#xA;    } else {&#xA;        // SQL Server&#xA;        longMax = 63;&#xA;    }&#xA;    if (campo.length &gt; longMax) {&#xA;        $this.err =  &quot;'&quot; + campo + &quot;' supera la longitud máxima permitida de &quot; + longMax + &quot; caracteres.&quot;; &#xA;        return;&#xA;    }&#xA;}&#xA;    &#xA;function validCaract(campo){&#xA;    if (campo.charAt(0) == &quot;_&quot; &amp;&amp; $db.type == &quot;oracle&quot;) {&#xA;            $this.err =  campo + &quot; no puede comenzar por _.&quot;; &#xA;            return;&#xA;    }&#xA;    for (var i = 0; i &lt; campo.length; i++) {&#xA;        if (CaracteresValidos.indexOf(campo.charAt(i)) &lt; 0){&#xA;            $this.err =  campo + &quot; tiene caracteres no válidos.&quot;;&#xA;            return;&#xA;        }&#xA;    }&#xA;}">
  <calculo id="cfd_tipodatos.edicion|cfd_tipodatos.edicion|203" padreid="cfd_tipodatos.edicion" tipo="203" calculo="/*[type=jscript]*/ &#xA;&#xA;var nbTabla = $F.getValue(&quot;NBTABLA&quot;).toLowerCase();&#xA;var nbCampoId = $F.getValue(&quot;NBCAMPOID&quot;).toLowerCase().replace(nbTabla + &quot;.&quot;, &quot;&quot;);&#xA;var nbCampoTitulo = $F.getValue(&quot;NBCAMPOTITULO&quot;).toLowerCase().replace(nbTabla + &quot;.&quot;, &quot;&quot;);&#xA;var longMax;&#xA;var CaracteresValidos = &quot;abcdefghijklmnopqrstuvwxyz0123456789_&quot;;&#xA;&#xA;validLong(nbTabla); validLong(nbCampoId); validLong(nbCampoTitulo);&#xA;validCaract(nbTabla); validCaract(nbCampoId); validCaract(nbCampoTitulo);&#xA;&#xA;function validLong(campo){&#xA;    if ($db.type == &quot;oracle&quot;) {&#xA;        longMax = 30;    &#xA;    } else if ($db.type == &quot;postgresql&quot;) {&#xA;        longMax = 128;&#xA;    } else {&#xA;        // SQL Server&#xA;        longMax = 63;&#xA;    }&#xA;    if (campo.length &gt; longMax) {&#xA;        $this.err =  &quot;'&quot; + campo + &quot;' supera la longitud máxima permitida de &quot; + longMax + &quot; caracteres.&quot;; &#xA;        return;&#xA;    }&#xA;}&#xA;    &#xA;function validCaract(campo){&#xA;    if (campo.charAt(0) == &quot;_&quot; &amp;&amp; $db.type == &quot;oracle&quot;) {&#xA;            $this.err =  campo + &quot; no puede comenzar por _.&quot;; &#xA;            return;&#xA;    }&#xA;    for (var i = 0; i &lt; campo.length; i++) {&#xA;        if (CaracteresValidos.indexOf(campo.charAt(i)) &lt; 0){&#xA;            $this.err =  campo + &quot; tiene caracteres no válidos.&quot;;&#xA;            return;&#xA;        }&#xA;    }&#xA;}" />
  <pa id="cfd_tipodatos.edicion|responsive" padreid="cfd_tipodatos.edicion" nombre="responsive" valor="1" sql="" />
  <pa id="cfd_tipodatos.edicion|responsivestatus" padreid="cfd_tipodatos.edicion" nombre="responsivestatus" valor="rev2pa" sql="" />
  <tab catalogformulariodesigner="cfd_tipodatos.edicion" id="1971" titulo="¬Catálogo" cssclass="" orden="0">
    <calculo padreid="1971" tipo="3" calculo="/*[type=jscript]*/ &#xA;&#xA;if ($F.getValue('Padre') &amp;&amp; (!$F.getValue(&quot;Sqlinithijo&quot;) || !$F.getValue('Sqlleerregistro'))){&#xA;    $sys.trace(&quot;El/Los Scripts No Tienen valor&quot;);&#xA;    $this.cssClass = &quot;empty&quot;;&#xA;}" />
    <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2029" titulo="" cssclass="" ncol="12" primeroenlinea="0" padre="1971" visible="1" orden="1">
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2030" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2029" visible="1" orden="1">
        <campo id="cfd_tipodatos.edicion|id" tipo="2" titulo="Id" campo="ID" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="" alto="0" etiqueta="2" tipomacro="2" orden="1" ncol="1" primeroenlinea="0" />
        <campo id="cfd_tipodatos.edicion|nombre" tipo="1" titulo="Nombre" campo="NOMBRE" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="" alto="20" etiqueta="2" longitud="255" password="" multilinea="0" tipomacro="1" orden="2" ncol="3" primeroenlinea="1" />
        <campo id="cfd_tipodatos.edicion|valoresfijos" tipo="11" titulo="¬Valores fijos" campo="VALORESFIJOS" visible="1" sololectura="0" obligatorio="0" ancho="0" ayuda="" alto="30" etiqueta="2" tipomacro="11" orden="3" ncol="1" primeroenlinea="0" />
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2200" titulo="" cssclass="" ncol="12" primeroenlinea="0" padre="2029" visible="1" orden="2">
        <campo id="cfd_tipodatos.edicion|nbtabla" tipo="1" titulo="Tabla de Datos" campo="NBTABLA" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="" alto="20" etiqueta="2" longitud="255" password="" multilinea="0" tipomacro="1" orden="1" ncol="4" primeroenlinea="0">
          <pa padreid="cfd_tipodatos.edicion|nbtabla" nombre="autocomplete" valor="1" sql="" />
          <pa padreid="cfd_tipodatos.edicion|nbtabla" nombre="autocomplete_script" valor="" sql="/*[type=sql]*/ &#xA;SELECT TABLE_NAME FROM CFD_TABLASYVISTAS &#xA;WHERE LOWER(TABLE_NAME) like LOWER([%pattern%])&#xA;ORDER BY TABLE_NAME" />
        </campo>
        <campo id="cfd_tipodatos.edicion|nbcampoid" tipo="1" titulo="Campo ID" campo="NBCAMPOID" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="" alto="20" etiqueta="2" longitud="255" password="" multilinea="0" tipomacro="1" orden="2" ncol="4" primeroenlinea="0">
          <pa padreid="cfd_tipodatos.edicion|nbcampoid" nombre="autocomplete" valor="1" sql="" />
          <pa padreid="cfd_tipodatos.edicion|nbcampoid" nombre="autocomplete_minlength" valor="2" sql="" />
          <pa padreid="cfd_tipodatos.edicion|nbcampoid" nombre="autocomplete_script" valor="" sql="--[@PGS!NBTabla]&#xA;SELECT TABLECOLUMN_NAME FROM CFD_COLUMNAS WHERE LOWER(TABLE_NAME) = LOWER([@PGS!NBTabla])&#xA;AND ( LOWER(COLUMN_NAME) LIKE LOWER([%pattern%]) OR LOWER(TABLECOLUMN_NAME) LIKE LOWER(([%pattern%])))&#xA;ORDER BY COLUMN_NAME" />
          <calculo padreid="cfd_tipodatos.edicion|nbcampoid" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/&#xA;&#xA;//[@PGS!NBTABLA]&#xA;&#xA;var NbTabla = (!$F.getValue(&quot;NBTABLA&quot;)? &quot;&quot; : $F.getValue(&quot;NBTABLA&quot;));&#xA;$sys.trace(&quot;Tabla Datos: &quot; + NbTabla);&#xA;var contador = $db.count(&quot;CFD_TABLASYVISTAS&quot;, &quot;TABLE_NAME&quot;, &quot;where lower(TABLE_NAME) = lower('&quot; + NbTabla + &quot;')&quot;);&#xA;$sys.trace(&quot;Contador: &quot; + contador);&#xA;&#xA;if (contador &lt; 1) {&#xA;    $this.alertLevel = 3;&#xA;    $this.alert = &quot;La tabla &quot; + NbTabla + &quot; no existe. Con el resto de campos obligatorios rellenos se creará la nueva tabla&quot;;&#xA;}" orden="0" asincrono="1" />
        </campo>
        <campo id="cfd_tipodatos.edicion|tiposql" tipo="1" titulo="¬Tipo para la columna de datos" campo="TIPOSQL" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="" alto="20" etiqueta="2" longitud="50" password="" multilinea="0" tipomacro="1" orden="3" ncol="2" primeroenlinea="0">
          <calculo padreid="cfd_tipodatos.edicion|tiposql" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/ &#xA;&#xA;if (!$F.getValue('Tiposql')) {&#xA;    if ($db.type==&quot;oracle&quot;) { &#xA;        $this.value = &quot;NUMERIC(10,0)&quot;;&#xA;    } else { &#xA;        // SQL Server &amp; PostgreSQL&#xA;        $this.value = &quot;int&quot;; &#xA;    } &#xA;}" orden="0" asincrono="1" />
        </campo>
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2031" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2029" visible="1" orden="3">
        <campo id="cfd_tipodatos.edicion|nbcampotitulo" tipo="1" titulo="¬Columna o expresión para el nombre del elemento" campo="NBCAMPOTITULO" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="" alto="20" etiqueta="2" longitud="255" password="" multilinea="0" tipomacro="1" orden="1" ncol="4" primeroenlinea="1">
          <pa padreid="cfd_tipodatos.edicion|nbcampotitulo" nombre="autocomplete" valor="1" sql="" />
          <pa padreid="cfd_tipodatos.edicion|nbcampotitulo" nombre="autocomplete_script" valor="" sql="--[@PGS!NBTabla]&#xD;&#xA;SELECT TABLECOLUMN_NAME FROM CFD_COLUMNAS WHERE LOWER(TABLE_NAME) = LOWER([@PGS!NBTabla])&#xD;&#xA;AND ( LOWER(COLUMN_NAME) LIKE LOWER([%pattern%]) OR LOWER(TABLECOLUMN_NAME) LIKE LOWER(([%pattern%])))&#xD;&#xA;ORDER BY COLUMN_NAME" />
        </campo>
        <campo id="cfd_tipodatos.edicion|padre" tipo="1265" titulo="¬Padre" campo="PADRE" visible="1" sololectura="0" obligatorio="0" ancho="0" ayuda="" alto="20" etiqueta="2" tipomacro="-1" orden="2" ncol="4" primeroenlinea="0">
          <tipocampo id="1265" nombre="*Selector CATALOGOS" catalogtipocontrol="3" padre="" tiposql="int" tipopgs="Combo" vinculada="0" nbtabla="CFD_TIPODATOS" nbcampoid="ID" nbcampotitulo="CFD_TIPODATOS.NOMBRE" sqlinit="/*[type=SQL]*/&#xA;SELECT ID,NOMBRE AS TITULO FROM CFD_TIPODATOS &#xA;WHERE id &gt;= 1000 AND (LOWER(Nombre) LIKE LOWER([%pattern%]))&#xA;ORDER BY NOMBRE" sqlinithijo="" sqlleerregistro="" tiposcondicion="=!" formulasqlcamposvista="" sistema="0" valoresfijos="0" campoid="" campotitulo="">
            <pa padreid="1265" nombre="autocomplete" valor="1" sql="" />
            <pa padreid="1265" nombre="dropdown_mode" valor="dropdowntoggle" sql="" />
          </tipocampo>
          <pa id="cfd_tipodatos.edicion|padre|selector_abierto" padreid="cfd_tipodatos.edicion|padre" propiedad="selector_abierto" valor="" />
        </campo>
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2032" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2029" visible="1" orden="5">
        <campo id="cfd_tipodatos.edicion|sqlinithijo" tipo="26" titulo="¬(Script) Inicialización para catalogos hijos a partir del valor del padre" campo="SQLINITHIJO" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="SELECT &lt;IdTablaPadre&gt;, &lt;Titulo&gt; AS Titulo FROM &lt;TablaPadre&gt; where &lt;CampoIdTablaPadre&gt; = [%IdPadre%]" alto="137" etiqueta="2" tipomacro="26" orden="1" ncol="6" primeroenlinea="0">
          <calculo padreid="cfd_tipodatos.edicion|sqlinithijo" tipo="1" bdtipo="3" calculo="/*[type=jscript]*/ &#xA;//[@PGS!Padre]&#xA;var Padre = $F.getValue(&quot;Padre&quot;);&#xA;if (Padre == null || Padre == '') {&#xA;    $this.visible = false;&#xA;    $this.enabled = false;&#xA;} else {&#xA;    $this.visible = true;&#xA;    $this.enabled = true;&#xA;}" orden="0" asincrono="1" />
        </campo>
        <campo id="cfd_tipodatos.edicion|sqlleerregistro" tipo="26" titulo="¬(Script) Obtiene el valor del padre en función del valor seleccionado en el catálogo hijo" campo="SQLLEERREGISTRO" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="¬Obener el valor en el catálogo padre a partir del valor seleccionado en el catálogo hijo" alto="137" etiqueta="2" tipomacro="26" orden="2" ncol="6" primeroenlinea="0">
          <calculo padreid="cfd_tipodatos.edicion|sqlleerregistro" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/ &#xA;//[@PGS!Padre]//&#xA;var Padre = $F.getValue(&quot;Padre&quot;);&#xA;if (Padre == null || Padre == '') {&#xA;    $this.visible = false;&#xA;    $this.enabled = false;&#xA;} else {&#xA;    $this.visible = true;&#xA;    $this.enabled = true;&#xA;}" orden="0" asincrono="1" />
        </campo>
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2116" titulo="" cssclass="" ncol="12" primeroenlinea="0" padre="2029" visible="1" orden="6">
        <campo id="cfd_tipodatos.edicion|sqlinit" tipo="26" titulo="¬(Script) Carga la lista de valores del catálogo" campo="SQLINIT" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="SELECT &lt;IdTabla&gt;, &lt;Titulo&gt; AS TITULO FROM..." alto="138" etiqueta="2" tipomacro="26" orden="1" ncol="12" primeroenlinea="1" />
      </bloque>
    </bloque>
  </tab>
  <tab catalogformulariodesigner="cfd_tipodatos.edicion" id="2123" titulo="¬Vista previa y Edición de catálogos" cssclass="" orden="2">
    <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2124" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2123" visible="1" orden="1">
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2265" titulo="" cssclass="PWCaja1" ncol="12" primeroenlinea="0" padre="2124" visible="1" orden="1">
        <campo id="cfd_tipodatos.edicion|nuevovalor" tipo="1" titulo="¬Añadir nuevo valor al catálogo" campo="NUEVOVALOR" visible="1" sololectura="0" obligatorio="0" ancho="0" ayuda="" alto="30" etiqueta="2" longitud="255" password="" multilinea="0" tipomacro="1" orden="1" ncol="3" primeroenlinea="0">
          <pa padreid="cfd_tipodatos.edicion|nuevovalor" nombre="computed" valor="1" sql="" />
        </campo>
        <elementodiseno id="2970" titulo="¬Añadir valor" catalogelementodiseno="2" ancho="7" alto="18" orden="2" ncol="2" primeroenlinea="0">
          <pa padreid="2970" nombre="cssclass" valor="PWButton" />
          <calculo padreid="2970" tipo="2" calculo="/*[type=jscript]*/ &#xA;function normalize(cad) {&#xA;    if (!cad) return &quot;&quot;;&#xA;    cad=cad.toLowerCase();&#xA;    cad=cad.split(&quot;,&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;\n&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot; &quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;]&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;[&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;'&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;;&quot;).join(&quot;&quot;);&#xA;    return cad;&#xA;}&#xA;$sys.trace(&quot;Ini&quot;);&#xA;var T=normalize($F.getValue('Nbtabla'));&#xA;var N=normalize($F.getValue('Nbcampotitulo')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;var NV =$F.getValue('NUEVOVALOR');&#xA;if(NV){NV=NV.split(&quot;'&quot;).join(&quot;''&quot;);}&#xA;var Q=&quot;INSERT INTO &quot; + T + &quot; (&quot; + N + &quot;) VALUES ('&quot; + (NV?NV:&quot;null&quot;) +&quot;')&quot;;&#xA;try {&#xA;if (T &amp;&amp; N &amp;&amp; NV) {&#xA; if ($db.type==&quot;oracle&quot; &amp;&amp; $db.version==&quot;11&quot;) {&#xA;     $sys.trace(&quot;ORa&quot;);&#xA;    var I=normalize($F.getValue('Nbcampoid')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;    var max=$db.executeSql(&quot;SELECT MAX(&quot;+I+&quot;)+1,'&quot; + N +&quot;' FROM &quot; + T).getValue(0,0);&#xA;    Q =&quot;INSERT INTO &quot; + T + &quot; (&quot; + I + &quot;,&quot; + N +&quot;) VALUES (&quot; + (max?max:1) +&quot;,'&quot;+NV+&quot;')&quot;;&#xA; }&#xA; $sys.trace(Q);&#xA; $db.executeCommand(Q);&#xA; $this.PGS(&quot;refreshform&quot;);&#xA;}&#xA;else {&#xA;$this.PGS(&quot;info&quot;,&quot;[%¬El campo no se puede añadir. Faltan datos en la definición del catalogo%]&quot;);&#xA;}&#xA;}&#xA;catch(err) {&#xA;    $this.PGS(&quot;info&quot;,&quot;[%¬El campo no se puede añadir. Se ha producido una excepción%]\n &quot; + err.message + &quot;\n&quot;+ Q );&#xA;}" />
        </elementodiseno>
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2266" titulo="" cssclass="" ncol="12" primeroenlinea="0" padre="2124" visible="1" orden="2">
        <campo id="cfd_tipodatos.edicion|todelete" tipo="1358" titulo="¬Seleccione valor para editar /borrar" campo="TODELETE" visible="1" sololectura="0" obligatorio="0" ancho="0" ayuda="" alto="30" etiqueta="2" tipomacro="-1" orden="1" ncol="3" primeroenlinea="0">
          <tipocampo id="1358" nombre="DualAuxCatalogo" catalogtipocontrol="3" padre="" tiposql="int" tipopgs="combo" vinculada="0" nbtabla="DUAL" nbcampoid="DUAL.DUMMY" nbcampotitulo="DUAL.DUMMY" sqlinit="/*[type=jscript]*/&#xD;&#xA;var Scr=&quot;&quot;+ $F.getValue(&quot;sqlinit&quot;);&#xD;&#xA;$sys.trace(Scr);&#xD;&#xA;if(!Scr) { return;}&#xD;&#xA;&#xD;&#xA;try { $this.datos=$db.executeSql(Scr)}&#xD;&#xA;catch(aError){&#xD;&#xA;    $this.datos.add(&quot;¬#ERROR#&quot;,&quot;-99999&quot;);&#xD;&#xA;}" sqlinithijo="" sqlleerregistro="" tiposcondicion="=!" formulasqlcamposvista="" sistema="0" valoresfijos="0" campoid="" campotitulo="" />
          <pa id="cfd_tipodatos.edicion|todelete|selector_abierto" padreid="cfd_tipodatos.edicion|todelete" propiedad="selector_abierto" valor="" />
          <pa padreid="cfd_tipodatos.edicion|todelete" nombre="computed" valor="1" sql="" />
        </campo>
        <campo id="cfd_tipodatos.edicion|toedit" tipo="1" titulo="¬Edite el título del elemento seleccionado" campo="TOEDIT" visible="1" sololectura="0" obligatorio="0" ancho="0" ayuda="" alto="30" etiqueta="2" longitud="255" password="" multilinea="0" tipomacro="1" orden="2" ncol="4" primeroenlinea="0">
          <pa padreid="cfd_tipodatos.edicion|toedit" nombre="computed" valor="1" sql="" />
          <calculo padreid="cfd_tipodatos.edicion|toedit" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/ &#xA;//[@PGS!todelete]&#xA;var Ed=$F.getValue(&quot;todelete&quot;);&#xA;if(!Ed) if(!(Ed===0)){&#xA;   $this.enabled=false;&#xA;   $this.value =&quot;&quot;;    &#xA;   return;&#xA;}&#xA;$this.enabled=false;&#xA;$this.value =&quot;&quot;;&#xA;function normalize(cad) {&#xA;    if (!cad) return &quot;&quot;;&#xA;    cad=cad.toLowerCase();&#xA;    cad=cad.split(&quot;,&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;\n&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot; &quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;]&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;[&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;'&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;;&quot;).join(&quot;&quot;);&#xA;    return cad;&#xA;}&#xA;var T=normalize($F.getValue('Nbtabla'));&#xA;var N=normalize($F.getValue('Nbcampotitulo')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;var I=normalize($F.getValue('Nbcampoid')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;var Q=&quot;SELECT &quot;+N+&quot; FROM &quot;+T+&quot; WHERE &quot;+I+&quot;=&quot;+Ed+&quot;&quot;;&#xA;var isnumeric = (!isNaN(parseFloat(Ed)) &amp;&amp; isFinite(Ed));&#xA;if (!isnumeric){&#xA;    Q=&quot;SELECT &quot;+N+&quot; FROM &quot;+T+&quot; WHERE &quot;+I+&quot;='&quot;+Ed.split(&quot;'&quot;).join(&quot;''&quot;)+&quot;'&quot;;&#xA;}&#xA;try {&#xA; var r=$db.executeSql(Q);&#xA; if (r.size() &gt; 1) {&#xA;     $this.enabled=false;&#xA;     $this.value =&quot;#Error:&quot; + r.size() + &quot; Results&quot;;&#xA;     return;&#xA; }&#xA; $this.enabled=true;&#xA; $this.value =r.getValue(0,0);&#xA;}&#xA;catch(err) {&#xA;    $this.enabled=false;&#xA;    $this.value =&quot;#Error:&quot; + err.message ;&#xA;}" orden="0" asincrono="1" />
        </campo>
        <elementodiseno id="2973" titulo="¬Modificar nombre" catalogelementodiseno="2" ancho="7" alto="18" orden="3" ncol="2" primeroenlinea="0">
          <pa padreid="2973" nombre="cssclass" valor="PWButton" />
          <calculo padreid="2973" tipo="2" calculo="/*[type=jscript]*/ &#xA;//[@PGS!todelete]&#xA;var Ed=$F.getValue(&quot;todelete&quot;);&#xA;var EdN=$F.getValue(&quot;toedit&quot;);&#xA;if(!Ed)if(!Ed===0) {$this.PGS(&quot;info&quot;,&quot;¬No hay valor para editar&quot;); return; }&#xA;if(!EdN){$this.PGS(&quot;info&quot;,&quot;¬Falta El texto&quot;); return; };&#xA;&#xA;function normalize(cad) {&#xA;    if (!cad) return &quot;&quot;;&#xA;    cad=cad.toLowerCase();&#xA;    cad=cad.split(&quot;,&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;\n&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot; &quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;]&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;[&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;'&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;;&quot;).join(&quot;&quot;);&#xA;    return cad;&#xA;}&#xA;var T=normalize($F.getValue('Nbtabla'));&#xA;var N=normalize($F.getValue('Nbcampotitulo')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;var I=normalize($F.getValue('Nbcampoid')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;var Q1=&quot;SELECT &quot;+N+&quot; FROM &quot;+T+&quot; WHERE &quot;+I;//&#xA;var Q2=&quot;UPDATE &quot;+T+&quot; SET &quot;+N+&quot;='&quot;+EdN.split(&quot;'&quot;).join(&quot;''&quot;)+&quot;' WHERE &quot;+I;&#xA;var isnumeric = (!isNaN(parseFloat(Ed)) &amp;&amp; isFinite(Ed));&#xA;if (isnumeric){&#xA;    Q1+=&quot;=&quot;+Ed;&#xA;    Q2+=&quot;=&quot;+Ed;&#xA;}&#xA;else {&#xA;    Q1+=&quot;='&quot;+Ed.split(&quot;'&quot;).join(&quot;''&quot;)+&quot;'&quot;;&#xA;    Q2+=&quot;='&quot;+Ed.split(&quot;'&quot;).join(&quot;''&quot;)+&quot;'&quot;;&#xA;}&#xA;try {&#xA; var r=$db.executeSql(Q1);&#xA; if (r.size() &gt; 1) {&#xA;     $this.PGS(&quot;info&quot;,&quot;#Error:&quot; + r.size() + &quot; Results&quot;);&#xA;     return;&#xA; }&#xA; $db.executeCommand(Q2);&#xA; $this.PGS(&quot;refreshform&quot;);&#xA;}&#xA;catch(err) {&#xA;    $this.PGS(&quot;info&quot;,&quot;#Error:&quot; + err.message + &quot; Results&quot;);&#xA;}" />
        </elementodiseno>
        <elementodiseno id="2974" titulo="¬Eliminar elemento del catálogo" catalogelementodiseno="2" ancho="7" alto="18" orden="4" ncol="2" primeroenlinea="0">
          <pa padreid="2974" nombre="cssclass" valor="PWButton red" />
          <pa padreid="2974" nombre="msjconfirm" valor="¬Cuidado, si se borra un valor en uso en algún formulario, podría provocar errores y pérdida de datos." />
          <calculo padreid="2974" tipo="2" calculo="/*[type=jscript]*/ &#xA;//[@PGS!todelete]&#xA;var Ed=$F.getValue(&quot;todelete&quot;);&#xA;if(!Ed) return;&#xA;&#xA;function normalize(cad) {&#xA;    if (!cad) return &quot;&quot;;&#xA;    cad=cad.toLowerCase();&#xA;    cad=cad.split(&quot;,&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;\n&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot; &quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;]&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;[&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;'&quot;).join(&quot;&quot;);&#xA;    cad=cad.split(&quot;;&quot;).join(&quot;&quot;);&#xA;    return cad;&#xA;}&#xA;var T=normalize($F.getValue('Nbtabla'));&#xA;var N=normalize($F.getValue('Nbcampotitulo')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;var I=normalize($F.getValue('Nbcampoid')).split(T+&quot;.&quot;).join(&quot;&quot;);&#xA;var isnumeric = (!isNaN(parseFloat(Ed)) &amp;&amp; isFinite(Ed));&#xA;var EdPart=&quot;&quot;;&#xA;if (isnumeric){ EdPart=&quot;=&quot;+Ed;}&#xA;else { EdPart=&quot;='&quot;+Ed.split(&quot;'&quot;).join(&quot;''&quot;)+&quot;'&quot;;}&#xA;var Q1=&quot;SELECT &quot;+N+&quot; FROM &quot;+T+&quot; WHERE &quot;+I+EdPart;&#xA;var Q2=&quot;DELETE FROM &quot;+T+&quot; WHERE &quot;+I+EdPart;&#xA;try {&#xA; var r=$db.executeSql(Q1);&#xA; if (r.size() &gt; 1) {&#xA;     $this.PGS(&quot;info&quot;,&quot;#Error:&quot; + r.size() + &quot; Results&quot;);&#xA;     return;&#xA; }&#xA; //Comprobar que no está en uso.&#xA; var Q3=&quot;SELECT DISTINCT CFD_TABLAANEXA.tablaanexa, CFD_CAMPO.campo,CFD_CAMPO.Nombre FROM CFD_TABLAANEXA,CFD_CAMPO WHERE CFD_TABLAANEXA.catalogFormularioDesigner=CFD_CAMPO.nombre AND CFD_CAMPO.Tipo=&quot; + $sys.idForm;&#xA; var uses=$db.executeSql(Q3);&#xA; var ErrList=[];&#xA; for (var i=0; i&lt;uses.size(); i++){&#xA;     var table = uses.getValue(i,0);&#xA;     var field = uses.getValue(i,1);&#xA;     var form = uses.getValue(i,2);&#xA;     var sqlcheck=&quot;SELECT COUNT(*) FROM &quot;+table+&quot; WHERE &quot;+field+EdPart;&#xA;     try {&#xA;         if ($db.executeSql(sqlcheck).getValue(0,0)&gt;0 )&#xA;         { ErrList.push(&quot;\n[&quot;+ form+&quot;].[&quot;+ field +&quot;]&quot;); }&#xA;     }&#xA;     catch(exUses){/*IgnoreError*/}&#xA; }&#xA; if (ErrList.length &gt; 0) {&#xA;    $this.PGS(&quot;info&quot;,&quot;#Error:Valor en uso&quot; + ErrList.join(&quot;&quot;));&#xA; }&#xA; else {&#xA;   $db.executeCommand(Q2);    &#xA; }&#xA; $this.PGS(&quot;refreshform&quot;);&#xA;}&#xA;catch(err) {&#xA;    $this.PGS(&quot;info&quot;,&quot;#Error:&quot; + err.message + &quot; Results&quot;);&#xA;}" />
        </elementodiseno>
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2296" titulo="" cssclass="" ncol="12" primeroenlinea="0" padre="2124" visible="1" orden="3">
        <elementodiseno id="2982" titulo="Nuevo Texto" catalogelementodiseno="1" ancho="7" alto="18" orden="1" ncol="12" primeroenlinea="0" />
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2294" titulo="" cssclass="" ncol="2" primeroenlinea="0" padre="2124" visible="1" orden="4" />
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2254" titulo="" cssclass="" ncol="8" primeroenlinea="0" padre="2124" visible="1" orden="5">
        <elementodiseno id="2937" titulo="Nuevo Texto" catalogelementodiseno="5" ancho="7" alto="138" orden="1" ncol="12" primeroenlinea="0">
          <pa padreid="2937" nombre="cssclass" valor="PWCaja" />
          <calculo padreid="2937" tipo="3" calculo="/*[type=jscript]*/ &#xA;/*&#xA;Ejecutar el [@PGS!Sqlinit]&#xA;Si hay resultados  crear una tabla con los resultados&#xA;*/&#xA;var Lista=null;&#xA;var Scr=&quot;&quot;+ $F.getValue(&quot;sqlinit&quot;);&#xA;$sys.trace(Scr);&#xA;&#xA;$this.HTML=&quot;&quot;;&#xA;if(!Scr) { return;}&#xA;&#xA;try { Lista=$db.executeSql(Scr)}&#xA;catch(aError){&#xA;    var tErr=aError.message;&#xA;    tErr=tErr.split('\n').join('&lt;br/&gt;');&#xA;    $this.HTML=&quot;&lt;div class='PWTextError resaltado' style='margin:30px; display:inline-block;'&gt;Error:&lt;br/&gt;&quot; + tErr +&quot;&lt;/div&gt;&quot;&#xA;    return;&#xA;}&#xA;$this.HTML=&quot;&lt;table class='table table-condensed PWTable PWHFix' style='min-width:500px; width:100%'&gt;&lt;thead&gt;&lt;tr class='PWTableHeader'&gt;&lt;td class='PWTableCellHeader'&gt;Id&lt;/td&gt;&lt;td class='PWTableCellHeader'&gt;Título&lt;/td&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&quot;&#xA;for (var i=0; i&lt;Lista.size; i++){&#xA;    var aId=Lista.getValue(i,0);&#xA;    var aTx=Lista.getValue(i,1);&#xA;    $this.HTML+=&quot;&lt;tr class='PWTableRow'&gt;&lt;td class='PWTableCell' style='text-align:left;'&gt;&quot;+ aId +&quot;&lt;/td&gt;&lt;td class='PWTableCell'&gt;&quot; + aTx + &quot;&lt;/td&gt;&lt;/tr&gt;&quot;&#xA;}&#xA;$this.HTML+=&quot;&lt;/tbody&gt;&lt;/table&gt;&quot;" />
        </elementodiseno>
      </bloque>
      <bloque catalogformulariodesigner="cfd_tipodatos.edicion" id="2295" titulo="" cssclass="" ncol="2" primeroenlinea="0" padre="2124" visible="1" orden="6" />
    </bloque>
  </tab>
  <calculo id="cfd_tipodatos.edicion|cfd_tipodatos.edicion|210" padreid="cfd_tipodatos.edicion" tipo="210" calculo="/*[type=jscript]*/ &#xA;&#xA;var nbTabla = (!$F.getValue(&quot;NBTABLA&quot;)? &quot;&quot; : $F.getValue(&quot;NBTABLA&quot;).toLowerCase());&#xA;$sys.trace(&quot;Tabla Datos: &quot; + nbTabla);&#xA;&#xA;var contador = $db.count(&quot;CFD_TABLASYVISTAS&quot;, &quot;TABLE_NAME&quot;, &quot;where lower(TABLE_NAME) = lower('&quot; + nbTabla + &quot;')&quot;);&#xA;$sys.trace(&quot;Contador: &quot; + contador);&#xA;&#xA;if (contador &lt; 1) {&#xA;    var nbCampoId = (!$F.getValue(&quot;NBCAMPOID&quot;)? &quot;&quot; : $F.getValue(&quot;NBCAMPOID&quot;).toLowerCase()).replace(nbTabla + &quot;.&quot;, &quot;&quot;);&#xA;    var nbCampoTitulo = (!$F.getValue(&quot;NBCAMPOTITULO&quot;)? &quot;&quot; : $F.getValue(&quot;NBCAMPOTITULO&quot;).toLowerCase()).replace(nbTabla + &quot;.&quot;, &quot;&quot;);&#xA;    $sys.trace(&quot;NameBBDD: &quot; + $db.type + &quot;; VersionBBDD: &quot; + $db.version);&#xA;    if ($db.type == &quot;oracle&quot; &amp;&amp; $db.version == '11') {&#xA;        $db.executeCommand('create table ' + nbTabla + '(' + nbCampoId + ' number(10) NOT NULL, ' + nbCampoTitulo + ' varchar2(255) NOT NULL, constraint PK_' + nbTabla + ' PRIMARY KEY(' + nbCampoId + '));');&#xA;        $db.executeCommand(&quot;CREATE SEQUENCE &quot; + nbTabla + &quot;_&quot; + nbCampoId + &quot;_seq START WITH 1;&quot;);&#xA;        $db.executeCommand(&quot;CREATE TRIGGER &quot; + nbTabla + &quot;_preIns_TR BEFORE INSERT ON &quot; + nbTabla + &quot; FOR EACH ROW BEGIN SELECT &quot; + nbTabla + &quot;_&quot; + nbCampoId + &quot;_seq.NEXTVAL INTO :new.&quot; + nbCampoId + &quot; FROM dual; END; --Fin&quot;);&#xA;    } else if($db.type == &quot;oracle&quot; &amp;&amp; $db.version == '12') {&#xA;        $db.executeCommand('create table ' + nbTabla + '(' + nbCampoId + ' number(10) GENERATED ALWAYS AS IDENTITY, ' + nbCampoTitulo + ' varchar2(255) NOT NULL, constraint PK_' + nbTabla + ' PRIMARY KEY(' + nbCampoId + '));');&#xA;    } else if($db.type == &quot;postgresql&quot;) {&#xA;        $db.executeCommand('create table ' + nbTabla + '(' + nbCampoId + ' serial, ' + nbCampoTitulo + ' varchar(255) NOT NULL, constraint PK_' + nbTabla + ' PRIMARY KEY(' + nbCampoId + '));');&#xA;    } else {&#xA;        // SQL Server&#xA;        $db.executeCommand('create table dbo.' + nbTabla + '(' + nbCampoId + ' int identity(1,1) NOT NULL, ' + nbCampoTitulo + ' varchar(255) NOT NULL, constraint PK_' + nbTabla + ' PRIMARY KEY(' + nbCampoId + '));');&#xA;    } &#xA;}" orden="0" asincrono="1" />
  <campo id="cfd_tipodatos.edicion|catalogtipocontrol" tipo="2" titulo="CatalogTipoControl" campo="CATALOGTIPOCONTROL" visible="1" sololectura="1" obligatorio="1" ancho="0" ayuda="" alto="20" etiqueta="2" tipomacro="2" orden="3" ncol="4" primeroenlinea="0">
    <calculo padreid="cfd_tipodatos.edicion|catalogtipocontrol" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/ &#xA;$this.value=3;" orden="0" asincrono="1" />
  </campo>
  <campo id="cfd_tipodatos.edicion|sistema" tipo="2" titulo="Sistema" campo="SISTEMA" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="" alto="20" etiqueta="2" tipomacro="2" orden="4" ncol="4" primeroenlinea="0">
    <calculo padreid="cfd_tipodatos.edicion|sistema" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/&#xA;$this.value = 0;" orden="0" asincrono="1" />
  </campo>
  <campo id="cfd_tipodatos.edicion|tipopgs" tipo="1" titulo="¬ Tipo interno PGS" campo="TIPOPGS" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="" alto="20" etiqueta="2" longitud="50" password="" multilinea="0" tipomacro="1" orden="4" ncol="4" primeroenlinea="0">
    <calculo padreid="cfd_tipodatos.edicion|tipopgs" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/ &#xA;/*1*/&#xA;if (!$F.getValue(&quot;tipopgs&quot;)) { $this.value = 'combo';}" orden="0" asincrono="1" />
  </campo>
  <campo id="cfd_tipodatos.edicion|tiposcondicion" tipo="1" titulo="TiposCondicion" campo="TIPOSCONDICION" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="" alto="20" etiqueta="2" longitud="20" password="" multilinea="0" tipomacro="1" orden="6" ncol="4" primeroenlinea="0">
    <calculo padreid="cfd_tipodatos.edicion|tiposcondicion" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/ &#xA;$this.value = '=!';" orden="0" asincrono="1" />
  </campo>
  <campo id="cfd_tipodatos.edicion|vinculada" tipo="2" titulo="Vinculada" campo="VINCULADA" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="" alto="20" etiqueta="2" tipomacro="2" orden="8" ncol="4" primeroenlinea="0">
    <calculo padreid="cfd_tipodatos.edicion|vinculada" tipo="1" bdtipo="1" calculo="/*[type=jscript]*/ &#xA;$this.value = 1;" orden="0" asincrono="1" />
  </campo>
</form>