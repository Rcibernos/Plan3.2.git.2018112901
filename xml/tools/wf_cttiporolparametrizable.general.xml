<form id="wf_cttiporolparametrizable.general" tablaanexa="WF_CTTIPOROLPARAMETRIZABLE" nbcampoid="ID" nombreexterno="General" nbbtablaoriginal="" ayuda="" sqlcamposvista="SELECT WF_CTTIPOROLPARAMETRIZABLE.iD,&#xD;dbo.PonerPuntuacionNumericaEntera(WF_CTTIPOROLPARAMETRIZABLE.Id) AS [Id|id],WF_CTTIPOROLPARAMETRIZABLE.Nombre AS [Nombre|NOMBRE],&#xD;Catalogproceso_TB.Nombre AS [Catalogproceso|CatalogProceso],WF_CTTIPOROLPARAMETRIZABLE.Txtsql AS [Txtsql|TxtSql]&#xD; FROM WF_CTTIPOROLPARAMETRIZABLE&#xD;LEFT OUTER JOIN WF_CTPROCESO Catalogproceso_TB ON WF_CTTIPOROLPARAMETRIZABLE.Catalogproceso=Catalogproceso_TB.Id&#xD; WHERE WF_CTTIPOROLPARAMETRIZABLE.iD=" dynaplantilla="" triggeralter="" estilo="" modocalculo="" nombrepadreid="" omitirpadreid="1" condiferencias="0" ncol="8" version="3">
  <pa id="wf_cttiporolparametrizable.general|responsive" padreid="wf_cttiporolparametrizable.general" nombre="responsive" valor="1" sql="" />
  <pa id="wf_cttiporolparametrizable.general|responsivestatus" padreid="wf_cttiporolparametrizable.general" nombre="responsivestatus" valor="rev2pa" sql="" />
  <tab catalogformulariodesigner="wf_cttiporolparametrizable.general" id="2111" titulo="¬Definición del Rol" cssclass="" orden="0">
    <bloque catalogformulariodesigner="wf_cttiporolparametrizable.general" id="2112" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2111" visible="1" orden="1">
      <bloque catalogformulariodesigner="wf_cttiporolparametrizable.general" id="2114" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2112" visible="1" orden="2">
        <campo id="wf_cttiporolparametrizable.general|id" tipo="2" titulo="id" campo="ID" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="" alto="20" etiqueta="2" tipomacro="2" orden="1" ncol="1" primeroenlinea="1" />
        <campo id="wf_cttiporolparametrizable.general|nombre" tipo="1" titulo="¬Nombre" campo="NOMBRE" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="" alto="0" etiqueta="2" longitud="50" password="" multilinea="0" tipomacro="1" orden="2" ncol="4" primeroenlinea="0" />
        <campo id="wf_cttiporolparametrizable.general|catalogproceso" tipo="1288" titulo="¬Proceso" campo="CATALOGPROCESO" visible="1" sololectura="0" obligatorio="0" ancho="0" ayuda="Si no se indica, el rol podrá usarse en todos los procesos" alto="20" etiqueta="2" tipomacro="-1" orden="3" ncol="3" primeroenlinea="0">
          <tipocampo id="1288" nombre="*Todos los tipos de proceso" catalogtipocontrol="3" padre="" tiposql="int" tipopgs="Combo" vinculada="0" nbtabla="WF_CTPROCESO" nbcampoid="ID" nbcampotitulo="WF_CTPROCESO.NOMBRE" sqlinit="/*[type=SQL]*/&#xD;&#xA;SELECT ID,NOMBRE AS TITULO FROM WF_CTPROCESO ORDER BY NOMBRE" sqlinithijo="" sqlleerregistro="" tiposcondicion="=!" formulasqlcamposvista="" sistema="0" valoresfijos="0" campoid="" campotitulo="" />
          <pa id="wf_cttiporolparametrizable.general|catalogproceso|selector_abierto" padreid="wf_cttiporolparametrizable.general|catalogproceso" propiedad="selector_abierto" valor="" />
        </campo>
      </bloque>
      <bloque catalogformulariodesigner="wf_cttiporolparametrizable.general" id="2115" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2112" visible="1" orden="3">
        <campo id="wf_cttiporolparametrizable.general|txtsql" tipo="26" titulo="¬Script para definición del rol" campo="TXTSQL" visible="1" sololectura="0" obligatorio="1" ancho="0" ayuda="¬El script debe devolver como resultado una lista de contratos" alto="297" etiqueta="2" tipomacro="26" orden="1" ncol="12" primeroenlinea="1">
          <pa padreid="wf_cttiporolparametrizable.general|txtsql" nombre="cfcolumn_visible" valor="0" sql="" />
          <pa padreid="wf_cttiporolparametrizable.general|txtsql" nombre="load_snippet" valor="usuario|form|constante" sql="" />
        </campo>
      </bloque>
    </bloque>
  </tab>
  <tab catalogformulariodesigner="wf_cttiporolparametrizable.general" id="2320" titulo="¬Fases en las que se incluye" cssclass="" orden="2">
    <bloque catalogformulariodesigner="wf_cttiporolparametrizable.general" id="2321" titulo="" cssclass="" ncol="12" primeroenlinea="1" padre="2320" visible="1" orden="1">
      <campo id="wf_cttiporolparametrizable.general|catalogfase" tipo="106" titulo="" campo="CATALOGFASE" visible="1" sololectura="1" obligatorio="0" ancho="0" ayuda="" alto="350" etiqueta="2" tabla="VIEW_WF_CATALOGFASE" formulario_edicion="wf_vcatalogfase.general" alto_formulario="0" ancho_formulario="0" limite_registros="25" formulario_columnas="wf_vcatalogfase.general" con_bajas="0" modo_seleccion="0" contador_de_registros="0" exportar_a_excel="0" nivel_de_agrupacion="0" tamano_de_pagina="0" modo_visualizar_formulario_emergente="0" modo_insercion_nuevos_registros="0" expandir_a_lo_alto="0" procedimiento_formulario_asincrono="" paginar_ver_todos="1" validar_grid_encambio_de_pagina="1" condicion="WHERE WF_VCatalogFase.CatalogTipoRolId=[%IdEnEjecucion%]" orderby="ORDER BY 2" accion_al_editar="" tipomacro="106" orden="1" ncol="12" primeroenlinea="0">
        <pa padreid="wf_cttiporolparametrizable.general|catalogfase" nombre="use_sqlcamposvista" valor="0" sql="" />
      </campo>
    </bloque>
  </tab>
  <calculo id="wf_cttiporolparametrizable.general|wf_cttiporolparametrizable.general|209" padreid="wf_cttiporolparametrizable.general" tipo="209" calculo="/*[type=jscript]*/ &#xA;var scriptSQL =&quot;&quot;;&#xA;//Vuelca todos los roles parametrizables que aún no existen en WF_CTTIPOROL&#xA;if ($db.type==&quot;oracle&quot;)&#xA;{&#xA;    if($db.version==&quot;11&quot;) {&#xA;    var scriptSQL =&quot;INSERT INTO WF_CTTIPOROL (ID,DESCRIPCION,TIPO,ID_TIPO) SELECT WF_CTTIPOROL_ID_SEQ.NEXTVAL,CASE WHEN NVL(NOMBRE,'')='' THEN TO_CHAR(ID) ELSE NOMBRE END,8,ID FROM WF_CTTIPOROLPARAMETRIZABLE WHERE ID NOT IN (SELECT ID_TIPO FROM WF_CTTIPOROL WHERE TIPO=8)&quot;;  }&#xA;    else {&#xA;    var scriptSQL =&quot;INSERT INTO WF_CTTIPOROL (DESCRIPCION,TIPO,ID_TIPO) SELECT CASE WHEN NVL(NOMBRE,'')='' THEN TO_CHAR(ID) ELSE NOMBRE END,8,ID FROM WF_CTTIPOROLPARAMETRIZABLE WHERE ID NOT IN (SELECT ID_TIPO FROM WF_CTTIPOROL WHERE TIPO=8)&quot;;}&#xA;}&#xA;else if ($db.type==&quot;postgresql&quot;){&#xA;    var scriptSQL =&quot;INSERT INTO WF_CTTIPOROL (DESCRIPCION,TIPO,ID_TIPO) SELECT CASE WHEN COALESCE(NOMBRE,'')='' THEN CAST(ID as character varying(10) ) ELSE NOMBRE END,8,ID FROM WF_CTTIPOROLPARAMETRIZABLE WHERE ID NOT IN (SELECT ID_TIPO FROM WF_CTTIPOROL WHERE TIPO=8)&quot;;    &#xA;}&#xA;else {&#xA;var scriptSQL =&quot;INSERT INTO WF_CTTIPOROL (DESCRIPCION,TIPO,ID_TIPO) SELECT CASE WHEN ISNULL(NOMBRE,'')='' THEN convert(varchar(10),ID) ELSE NOMBRE END,8,ID FROM WF_CTTIPOROLPARAMETRIZABLE WHERE ID NOT IN (SELECT ID_TIPO FROM WF_CTTIPOROL WHERE TIPO=8)&quot;;&#xA;}&#xA;&#xA;$db.executeCommand(scriptSQL);" orden="0" asincrono="1" />
  <calculo id="wf_cttiporolparametrizable.general|wf_cttiporolparametrizable.general|210" padreid="wf_cttiporolparametrizable.general" tipo="210" calculo="/*[type=jscript]*/ &#xA;//Actualiza el nombre&#xA;var i = $sys.idForm;&#xA;var scriptSQL =&quot;UPDATE WF_CTTIPOROL SET DESCRIPCION = (SELECT NOMBRE FROM WF_CTTIPOROLPARAMETRIZABLE WHERE ID=&quot; + i + &quot;) WHERE TIPO=8 AND ID_TIPO=&quot; + i;&#xA;$db.executeCommand(scriptSQL);" orden="0" asincrono="1" />
</form>